/*!
 * maska v1.5.2
 * (c) 2019-2022 Alexander Shabunevich
 * Released under the MIT License.
 */
function e(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function t(t){for(var r=1;r<arguments.length;r++){var n=null!=arguments[r]?arguments[r]:{};r%2?e(Object(n),!0).forEach((function(e){a(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):e(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,o(n.key),n)}}function a(e,t,r){return(t=o(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function o(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}var i={"#":{pattern:/[0-9]/},X:{pattern:/[0-9a-zA-Z]/},S:{pattern:/[a-zA-Z]/},A:{pattern:/[a-zA-Z]/,uppercase:!0},a:{pattern:/[a-zA-Z]/,lowercase:!0},"!":{escape:!0},"*":{repeat:!0}};function s(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:i,n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return u(t).length>1?p(t)(e,t,r,n):l(e,t,r,n)}function u(e){try{return JSON.parse(e)}catch(t){return[e]}}function p(e){var t=u(e).sort((function(e,t){return e.length-t.length}));return function(e,n,a){var o=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=t.map((function(t){return l(e,t,a,!1)})),s=i.pop();for(var u in t)if(r(s,t[u],a))return l(e,t[u],a,o);return""};function r(e,t,r){for(var n in r)r[n].escape&&(t=t.replace(new RegExp(n+".{1}","g"),""));return t.split("").filter((function(e){return r[e]&&r[e].pattern})).length>=e.length}}function l(e,t,r){for(var n=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],a=0,o=0,i="",s="";a<t.length&&o<e.length;){var u=t[a],p=e[o],l=r[u];if(l&&l.pattern)l.pattern.test(p)&&(i+=c(p,l),a++,n&&t[a]&&(r[t[a]]?r[t[a]]&&r[t[a]].escape&&(i+=t[a+1],a+=2):(i+=t[a],a++))),o++;else if(l&&l.repeat){var f=r[t[a-1]];f&&!f.pattern.test(p)?a++:a--}else l&&l.escape&&(u=t[++a]),n&&(i+=u),p===u&&o++,a++}for(;n&&a<t.length;){var v=t[a];if(r[v]){s="";break}s+=v,a++}return i+s}function c(e,t){return t.transform&&(e=t.transform(e)),t.uppercase?e.toLocaleUpperCase():t.lowercase?e.toLocaleLowerCase():e}function f(e){return e instanceof HTMLInputElement?e:e.querySelector("input")||e}function v(e){return"[object String]"===Object.prototype.toString.call(e)}var d=function(){function e(n){var a=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(r(this,e),!n)throw new Error("Maska: no element for mask");if(null!=o.preprocessor&&"function"!=typeof o.preprocessor)throw new Error("Maska: preprocessor must be a function");if(o.tokens)for(var s in o.tokens)o.tokens[s]=t({},o.tokens[s]),o.tokens[s].pattern&&v(o.tokens[s].pattern)&&(o.tokens[s].pattern=new RegExp(o.tokens[s].pattern));this._opts={mask:o.mask,tokens:t(t({},i),o.tokens),preprocessor:o.preprocessor},this._el=v(n)?document.querySelectorAll(n):n.length?n:[n],this.inputEvent=function(e){return a.updateValue(e.target,e)},this.init()}var a,o,u;return a=e,o=[{key:"init",value:function(){for(var e=this,t=function(t){var r=f(e._el[t]);!e._opts.mask||r.dataset.mask&&r.dataset.mask===e._opts.mask||(r.dataset.mask=e._opts.mask),setTimeout((function(){return e.updateValue(r)}),0),r.dataset.maskInited||(r.dataset.maskInited=!0,r.addEventListener("input",e.inputEvent),r.addEventListener("beforeinput",e.beforeInput))},r=0;r<this._el.length;r++)t(r)}},{key:"destroy",value:function(){for(var e=0;e<this._el.length;e++){var t=f(this._el[e]);t.removeEventListener("input",this.inputEvent),t.removeEventListener("beforeinput",this.beforeInput),delete t.dataset.mask,delete t.dataset.maskInited}}},{key:"updateValue",value:function(e,t){if(e&&e.type){var r=e.type.match(/^number$/i)&&e.validity.badInput;if(!e.value&&!r||!e.dataset.mask)return e.dataset.maskRawValue="",void this.dispatch("maska",e,t);var n=e.selectionEnd,a=e.value,o=a[n-1];e.dataset.maskRawValue=s(e.value,e.dataset.mask,this._opts.tokens,!1);var i=e.value;this._opts.preprocessor&&(i=this._opts.preprocessor(i)),e.value=s(i,e.dataset.mask,this._opts.tokens),t&&"insertText"===t.inputType&&n===a.length&&(n=e.value.length),function(e,t,r){for(;t&&t<e.value.length&&e.value.charAt(t-1)!==r;)t++;(e.type?e.type.match(/^(text|search|password|tel|url)$/i):!e.type)&&e===document.activeElement&&(e.setSelectionRange(t,t),setTimeout((function(){e.setSelectionRange(t,t)}),0))}(e,n,o),this.dispatch("maska",e,t),e.value!==a&&this.dispatch("input",e,t)}}},{key:"beforeInput",value:function(e){e&&e.target&&e.target.type&&e.target.type.match(/^number$/i)&&e.data&&isNaN(e.target.value+e.data)&&e.preventDefault()}},{key:"dispatch",value:function(e,t,r){t.dispatchEvent(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=document.createEvent("Event");return r.initEvent(e,!0,!0),t&&(r.inputType=t),r}(e,r&&r.inputType||null))}}],o&&n(a.prototype,o),u&&n(a,u),Object.defineProperty(a,"prototype",{writable:!1}),e}();var m,h=(m=new WeakMap,function(e,r){r.value&&(m.has(e)&&!function(e){return!(v(e.value)&&e.value===e.oldValue||Array.isArray(e.value)&&JSON.stringify(e.value)===JSON.stringify(e.oldValue)||e.value&&e.value.mask&&e.oldValue&&e.oldValue.mask&&e.value.mask===e.oldValue.mask)}(r)||m.set(e,new d(e,function(e){var r={};return e.mask?(r.mask=Array.isArray(e.mask)?JSON.stringify(e.mask):e.mask,r.tokens=e.tokens?t({},e.tokens):{},r.preprocessor=e.preprocessor):r.mask=Array.isArray(e)?JSON.stringify(e):e,r}(r.value))))});function k(e){e.directive("maska",h)}function y(e,t){return new d(e,t)}"undefined"!=typeof window&&window.Vue&&window.Vue.use&&window.Vue.use(k);export{y as create,k as default,k as install,s as mask,h as maska,i as tokens};
