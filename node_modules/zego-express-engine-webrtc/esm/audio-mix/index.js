!function(t,i){if("object"==typeof exports&&"object"==typeof module)module.exports=i(require("zego-express-engine-webrtm"));else if("function"==typeof define&&define.amd)define(["zego-express-engine-webrtm"],i);else{var e="object"==typeof exports?i(require("zego-express-engine-webrtm")):i(t["zego-express-engine-webrtm"]);for(var n in e)("object"==typeof exports?exports:t)[n]=e[n]}}("undefined"!=typeof self?self:this,(function(t){return function(){var i={3720:function(t){t.exports=e;var i=null;try{i=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function e(t,i,e){this.low=0|t,this.high=0|i,this.unsigned=!!e}function n(t){return!0===(t&&t.__isLong__)}Object.defineProperty(e.prototype,"__isLong__",{value:!0}),e.isLong=n;var r={},s={};function u(t,i){var e,n,u;return i?(u=0<=(t>>>=0)&&t<256)&&(n=s[t])?n:(e=c(t,(0|t)<0?-1:0,!0),u&&(s[t]=e),e):(u=-128<=(t|=0)&&t<128)&&(n=r[t])?n:(e=c(t,t<0?-1:0,!1),u&&(r[t]=e),e)}function o(t,i){if(isNaN(t))return i?g:p;if(i){if(t<0)return g;if(t>=l)return _}else{if(t<=-m)return D;if(t+1>=m)return y}return t<0?o(-t,i).neg():c(t%d|0,t/d|0,i)}function c(t,i,n){return new e(t,i,n)}e.fromInt=u,e.fromNumber=o,e.fromBits=c;var h=Math.pow;function a(t,i,e){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return p;if("number"==typeof i?(e=i,i=!1):i=!!i,(e=e||10)<2||36<e)throw RangeError("radix");var n;if((n=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return a(t.substring(1),i,e).neg();for(var r=o(h(e,8)),s=p,u=0;u<t.length;u+=8){var c=Math.min(8,t.length-u),f=parseInt(t.substring(u,u+c),e);if(c<8){var d=o(h(e,c));s=s.mul(d).add(o(f))}else s=(s=s.mul(r)).add(o(f))}return s.unsigned=i,s}function f(t,i){return"number"==typeof t?o(t,i):"string"==typeof t?a(t,i):c(t.low,t.high,"boolean"==typeof i?i:t.unsigned)}e.fromString=a,e.fromValue=f;var d=4294967296,l=d*d,m=l/2,v=u(1<<24),p=u(0);e.ZERO=p;var g=u(0,!0);e.UZERO=g;var b=u(1);e.ONE=b;var E=u(1,!0);e.UONE=E;var I=u(-1);e.NEG_ONE=I;var y=c(-1,2147483647,!1);e.MAX_VALUE=y;var _=c(-1,-1,!0);e.MAX_UNSIGNED_VALUE=_;var D=c(0,-2147483648,!1);e.MIN_VALUE=D;var w=e.prototype;w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},w.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(D)){var i=o(t),e=this.div(i),n=e.mul(i).sub(this);return e.toString(t)+n.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var r=o(h(t,6),this.unsigned),s=this,u="";;){var c=s.div(r),a=(s.sub(c.mul(r)).toInt()>>>0).toString(t);if((s=c).isZero())return a+u;for(;a.length<6;)a="0"+a;u=""+a+u}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(D)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,i=31;i>0&&0==(t&1<<i);i--);return 0!=this.high?i+33:i+1},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(t){return n(t)||(t=f(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},w.eq=w.equals,w.notEquals=function(t){return!this.eq(t)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(t){return this.comp(t)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(t){return this.comp(t)<=0},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(t){return this.comp(t)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(t){return this.comp(t)>=0},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(t){if(n(t)||(t=f(t)),this.eq(t))return 0;var i=this.isNegative(),e=t.isNegative();return i&&!e?-1:!i&&e?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(D)?D:this.not().add(b)},w.neg=w.negate,w.add=function(t){n(t)||(t=f(t));var i=0,e=0,r=0,s=0;return r+=(s+=(65535&this.low)+(65535&t.low))>>>16,e+=(r+=(this.low>>>16)+(t.low>>>16))>>>16,i+=(e+=(65535&this.high)+(65535&t.high))>>>16,i+=(this.high>>>16)+(t.high>>>16),c((r&=65535)<<16|(s&=65535),(i&=65535)<<16|(e&=65535),this.unsigned)},w.subtract=function(t){return n(t)||(t=f(t)),this.add(t.neg())},w.sub=w.subtract,w.multiply=function(t){if(this.isZero())return p;if(n(t)||(t=f(t)),i)return c(i.mul(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned);if(t.isZero())return p;if(this.eq(D))return t.isOdd()?D:p;if(t.eq(D))return this.isOdd()?D:p;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(v)&&t.lt(v))return o(this.toNumber()*t.toNumber(),this.unsigned);var e=65535&this.high,r=this.low>>>16,s=65535&this.low,u=65535&t.high,h=t.low>>>16,a=65535&t.low,d=0,l=0,m=0,g=0;return m+=(g+=s*a)>>>16,l+=(m+=r*a)>>>16,m&=65535,l+=(m+=s*h)>>>16,d+=(l+=e*a)>>>16,l&=65535,d+=(l+=r*h)>>>16,l&=65535,d+=(l+=s*u)>>>16,d+=(this.high>>>16)*a+e*h+r*u+s*(t.high>>>16),c((m&=65535)<<16|(g&=65535),(d&=65535)<<16|(l&=65535),this.unsigned)},w.mul=w.multiply,w.divide=function(t){if(n(t)||(t=f(t)),t.isZero())throw Error("division by zero");var e,r,s;if(i)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?c((this.unsigned?i.div_u:i.div_s)(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:p;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return g;if(t.gt(this.shru(1)))return E;s=g}else{if(this.eq(D))return t.eq(b)||t.eq(I)?D:t.eq(D)?b:(e=this.shr(1).div(t).shl(1)).eq(p)?t.isNegative()?b:I:(r=this.sub(t.mul(e)),s=e.add(r.div(t)));if(t.eq(D))return this.unsigned?g:p;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();s=p}for(r=this;r.gte(t);){e=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var u=Math.ceil(Math.log(e)/Math.LN2),a=u<=48?1:h(2,u-48),d=o(e),l=d.mul(t);l.isNegative()||l.gt(r);)l=(d=o(e-=a,this.unsigned)).mul(t);d.isZero()&&(d=b),s=s.add(d),r=r.sub(l)}return s},w.div=w.divide,w.modulo=function(t){return n(t)||(t=f(t)),i?c((this.unsigned?i.rem_u:i.rem_s)(this.low,this.high,t.low,t.high),i.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return c(~this.low,~this.high,this.unsigned)},w.and=function(t){return n(t)||(t=f(t)),c(this.low&t.low,this.high&t.high,this.unsigned)},w.or=function(t){return n(t)||(t=f(t)),c(this.low|t.low,this.high|t.high,this.unsigned)},w.xor=function(t){return n(t)||(t=f(t)),c(this.low^t.low,this.high^t.high,this.unsigned)},w.shiftLeft=function(t){return n(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):c(0,this.low<<t-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(t){return n(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?c(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):c(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(t){if(n(t)&&(t=t.toInt()),0===(t&=63))return this;var i=this.high;return t<32?c(this.low>>>t|i<<32-t,i>>>t,this.unsigned):c(32===t?i:i>>>t-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},w.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var t=this.high,i=this.low;return[255&i,i>>>8&255,i>>>16&255,i>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},w.toBytesBE=function(){var t=this.high,i=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,i>>>24,i>>>16&255,i>>>8&255,255&i]},e.fromBytes=function(t,i,n){return n?e.fromBytesLE(t,i):e.fromBytesBE(t,i)},e.fromBytesLE=function(t,i){return new e(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,i)},e.fromBytesBE=function(t,i){return new e(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],i)}},3873:function(t,i,e){"use strict";e.d(i,{ds:function(){return O},lq:function(){return N}});var n,r;e(4119);!function(t){t[t.debug=0]="debug",t[t.info=1]="info",t[t.warn=2]="warn",t[t.error=3]="error",t[t.report=99]="report",t[t.disable=100]="disable"}(n||(n={})),function(t){t[t.CN=2]="CN",t[t.NA=3]="NA",t[t.EU=4]="EU",t[t.AS=5]="AS",t[t.IN=6]="IN",t[t.NCN=7]="NCN"}(r||(r={}));var s,u;!function(t){t[t.disable=0]="disable",t[t.websocket=1]="websocket",t[t.https=2]="https"}(s||(s={})),function(t){t[t.SDKProject_Other=0]="SDKProject_Other",t[t.SDKProject_ZegoExpressVideo=1]="SDKProject_ZegoExpressVideo",t[t.SDKProject_ZegoExpressAudio=2]="SDKProject_ZegoExpressAudio",t[t.SDKProject_ZegoLiveRoom=3]="SDKProject_ZegoLiveRoom",t[t.SDKProject_ZegoAudioRoom=4]="SDKProject_ZegoAudioRoom",t[t.SDKProject_ZegoAVKit=5]="SDKProject_ZegoAVKit",t[t.SDKProject_ZegoWebRTC=6]="SDKProject_ZegoWebRTC",t[t.SDKProject_ZegoMiniProgram=7]="SDKProject_ZegoMiniProgram"}(u||(u={}));var o;!function(t){t[t.disconnected=0]="disconnected",t[t.connecting=1]="connecting",t[t.connected=2]="connected"}(o||(o={}));var c,h,a,f;!function(t){t[t.tryProbe=0]="tryProbe",t[t.probed=2]="probed"}(c||(c={})),function(t){t[t.CDN=0]="CDN",t[t.RTC=1]="RTC",t[t.L3=2]="L3",t[t.DG=3]="DG"}(h||(h={})),function(t){t[t.UDP=0]="UDP",t[t.RTMP=1]="RTMP",t[t.FLV=2]="FLV",t[t.HLS=3]="HLS",t[t.WEBRTC=4]="WEBRTC"}(a||(a={})),function(t){t[t.replaceNew=0]="replaceNew",t[t.changeResolution=1]="changeResolution"}(f||(f={}));var d,l,m;!function(t){t[t.logout=0]="logout",t[t.trylogin=1]="trylogin",t[t.login=2]="login"}(d||(d={})),function(t){t[t.logout=0]="logout",t[t.trylogin=1]="trylogin",t[t.login=2]="login",t[t.reconnect=3]="reconnect"}(l||(l={})),function(t){t[t.offline=0]="offline",t[t.online=1]="online"}(m||(m={}));var v;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CDN=1]="CDN",t[t.RTC=2]="RTC",t[t.L3=3]="L3"}(v||(v={}));var p,g;!function(t){t[t.publish_quality=0]="publish_quality",t[t.play_quality=1]="play_quality",t[t.charge=2]="charge"}(p||(p={})),function(t){t[t.low=1]="low",t[t.stantard=2]="stantard",t[t.hight=3]="hight",t[t.custome=4]="custome"}(g||(g={}));var b,E,I,y,_,D;!function(t){t[t.captureFpsToLow=1001]="captureFpsToLow",t[t.captureVolumeToLow=1002]="captureVolumeToLow",t[t.sendVideoBitrateToLow=1003]="sendVideoBitrateToLow",t[t.sendFpsToLow=1004]="sendFpsToLow",t[t.sendAudioBitrateToLow=1005]="sendAudioBitrateToLow",t[t.receiveVolumeToLow=1006]="receiveVolumeToLow",t[t.receiveAudioDecodedFail=1007]="receiveAudioDecodedFail",t[t.receiveVideoDecodedFail=1008]="receiveVideoDecodedFail",t[t.receiveVideoFpsDecodedToLow=1009]="receiveVideoFpsDecodedToLow",t[t.renderVideoFpsToLow=1010]="renderVideoFpsToLow",t[t.captureFpsNormal=2001]="captureFpsNormal",t[t.captureVolumeNormal=2002]="captureVolumeNormal",t[t.sendVideoBitrateNormal=2003]="sendVideoBitrateNormal",t[t.sendFpsNormal=2004]="sendFpsNormal",t[t.sendAudioBitrateNormal=2005]="sendAudioBitrateNormal",t[t.receiveVolumeNormal=2006]="receiveVolumeNormal",t[t.receiveAudioDecodedNormal=2007]="receiveAudioDecodedNormal",t[t.receiveVideoDecodedNormal=2008]="receiveVideoDecodedNormal",t[t.receiveVideoFpsDecodedNormal=2009]="receiveVideoFpsDecodedNormal",t[t.renderVideoFpsNormal=2010]="renderVideoFpsNormal"}(b||(b={})),function(t){t[t.cdn=0]="cdn",t[t.ultra=1]="ultra"}(E||(E={})),function(t){t[t.stop=0]="stop",t[t.start=1]="start"}(I||(I={})),function(t){t[t.cdn=0]="cdn",t[t.ultra=1]="ultra",t[t.customUrl=2]="customUrl"}(y||(y={})),function(t){t[t.CDN=0]="CDN",t[t.BGP=1]="BGP"}(_||(_={})),function(t){t[t.ClientType_None=0]="ClientType_None",t[t.ClientType_H5=1]="ClientType_H5",t[t.ClientType_SmallPragram=2]="ClientType_SmallPragram",t[t.ClientType_Webrtc=3]="ClientType_Webrtc"}(D||(D={}));var w,S,C,R,T,V,x,z,N,O,M,H,P,k,L,A=function(){function t(t,i){void 0===t&&(t=null),void 0===i&&(i=null),this._id=null,this.next=null,this.prev=null,this._id=t,this._data=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id?this._id:null},set:function(t){this._id=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),t.prototype.hasNext=function(){return this.next&&this.next.id},t.prototype.hasPrev=function(){return this.prev&&this.prev.id},t}();!function(){function t(){this.start=new A,this.end=new A,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}t.prototype.insertBefore=function(t,i){var e=new A(this._idCounter,i);return e.next=t,e.prev=t.prev,t.prev&&(t.prev.next=e),t.prev=e,++this._idCounter,++this._numNodes,e},t.prototype.addLast=function(t){return this.insertBefore(this.end,t)},t.prototype.add=function(t){return this.addLast(t)},t.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},t.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},t.prototype.size=function(){return this._numNodes},t.prototype.getFromFirst=function(t){var i=0,e=this.start.next;if(t>=0)for(;i<t&&null!==e;)e=e.next,++i;else e=null;if(null===e)throw"Index out of bounds.";return e},t.prototype.get=function(t){return 0===t?this.getFirst():t===this._numNodes-1?this.getLast():this.getFromFirst(t)},t.prototype.remove=function(t){return t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),--this._numNodes,t},t.prototype.removeFirst=function(){var t=null;return this._numNodes>0&&this.start.next&&(t=this.remove(this.start.next)),t},t.prototype.removeLast=function(){var t=null;return this._numNodes>0&&this.end.prev&&(t=this.remove(this.end.prev)),t},t.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},t.prototype.each=function(t){for(var i=this.start;i.hasNext();)t(i=i.next)},t.prototype.find=function(t){for(var i=this.start,e=!1,n=null;i.hasNext()&&!e;)t(i=i.next)&&(n=i,e=!0);return n},t.prototype.map=function(t){for(var i=this.start,e=[];i.hasNext();)t(i=i.next)&&e.push(i);return e},t.prototype.push=function(t){return this.addLast(t)},t.prototype.unshift=function(t){this.insertBefore(this._numNodes>0?this.start.next:this.end,t)},t.prototype.pop=function(){return this.removeLast()},t.prototype.shift=function(){return this.removeFirst()}}();!function(t){t[t.Unknown=-1]="Unknown",t[t.Excellent=0]="Excellent",t[t.Good=1]="Good",t[t.Middle=2]="Middle",t[t.Poor=3]="Poor",t[t.Die=4]="Die"}(w||(w={})),function(t){t[t.MinQuality=0]="MinQuality",t[t.DieQuality=0]="DieQuality",t[t.PoorMinQuality=1]="PoorMinQuality",t[t.MiddleMinQuality=30]="MiddleMinQuality",t[t.GoodMinQuality=60]="GoodMinQuality",t[t.ExcellentMinQuality=85]="ExcellentMinQuality",t[t.MaxQuality=100]="MaxQuality"}(S||(S={})),function(t){t[t.ZegoDefined=0]="ZegoDefined",t[t.UserUnregister=1]="UserUnregister"}(C||(C={})),function(t){t[t.CDN=0]="CDN",t[t.L3=1]="L3"}(R||(R={})),function(t){t[t.RTC=0]="RTC",t[t.CDN=1]="CDN",t[t.L3=2]="L3",t[t.DG=3]="DG"}(T||(T={})),function(t){t[t.PortraitSegmentation=0]="PortraitSegmentation"}(V||(V={})),function(t){t[t.Default=3]="Default",t[t.StandardVideoCall=4]="StandardVideoCall",t[t.HighVideoCall=5]="HighVideoCall",t[t.StandardChatroom=6]="StandardChatroom",t[t.HighQualityChatroom=7]="HighQualityChatroom",t[t.Broadcast=8]="Broadcast",t[t.UNKNOWN=100]="UNKNOWN"}(x||(x={})),function(t){t[t.I=0]="I",t[t.H=10]="H",t[t.M=100]="M",t[t.L=1e3]="L"}(z||(z={})),function(t){t[t.BASE_LINE=1]="BASE_LINE",t[t.MAIN=2]="MAIN",t[t.HIGH=3]="HIGH"}(N||(N={})),function(t){t.ONLY_BASELINE="only_baseline",t.HARD_SOFT_ENCODEC_FIRST="hard_or_soft_encodec_first",t.HIGH_PROFILE_FIRST="high_profile_first"}(O||(O={})),function(t){t[t.useAnalyzer=0]="useAnalyzer",t[t.useWorklet=1]="useWorklet"}(M||(M={})),function(t){t[t.None=0]="None",t[t.Vocalist=1]="Vocalist",t[t.BackingSinging=2]="BackingSinging"}(H||(H={})),function(t){t[t.METHOD_UNSET=0]="METHOD_UNSET",t[t.METHOD_GET=1]="METHOD_GET",t[t.METHOD_POST=2]="METHOD_POST",t[t.METHOD_PUT=3]="METHOD_PUT",t[t.METHOD_PATCH=4]="METHOD_PATCH",t[t.METHOD_DELETE=5]="METHOD_DELETE",t[t.METHOD_HEAD=6]="METHOD_HEAD",t[t.METHOD_OPTIONS=7]="METHOD_OPTIONS"}(P||(P={})),function(t){t[t.SERVICE_UNSET=0]="SERVICE_UNSET",t[t.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",t[t.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",t[t.SERVICE_MIX=3]="SERVICE_MIX",t[t.SERVICE_ZEUS=4]="SERVICE_ZEUS",t[t.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",t[t.SERVICE_L3=6]="SERVICE_L3",t[t.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",t[t.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",t[t.SERVICE_ZIM=9]="SERVICE_ZIM",t[t.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",t[t.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",t[t.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",t[t.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",t[t.SERVICE_QUALITY=14]="SERVICE_QUALITY",t[t.SERVICE_SECURITY=15]="SERVICE_SECURITY",t[t.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",t[t.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",t[t.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",t[t.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",t[t.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",t[t.SERVICE_CDN=21]="SERVICE_CDN",t[t.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",t[t.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",t[t.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",t[t.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",t[t.SERVICE_ECHO=26]="SERVICE_ECHO",t[t.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",t[t.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR"}(k||(k={})),function(t){t[t.Default=0]="Default",t[t.Extranet=1]="Extranet",t[t.Intranet=2]="Intranet"}(L||(L={}))},1945:function(t,i,e){"use strict";e.d(i,{B_k:function(){return l},Bo8:function(){return a},Ccg:function(){return ht},Cqc:function(){return ot},DFx:function(){return j},EQN:function(){return U},E_F:function(){return F},FJ5:function(){return g},FfT:function(){return S},IAb:function(){return Vt},Ig8:function(){return it},IlQ:function(){return z},JP1:function(){return Dt},JkR:function(){return tt},KC1:function(){return c},LXI:function(){return d},LbG:function(){return H},LbU:function(){return y},NAc:function(){return x},Ocl:function(){return nt},Ozi:function(){return b},Pv8:function(){return Et},QQV:function(){return P},Qij:function(){return It},Qmj:function(){return Ct},QtR:function(){return f},Qvv:function(){return E},RBy:function(){return vt},Rp2:function(){return ft},S42:function(){return ct},SCO:function(){return m},SxX:function(){return N},T5M:function(){return ut},THg:function(){return St},Tmx:function(){return s},UB3:function(){return at},UIH:function(){return u},UTJ:function(){return bt},VNz:function(){return Z},Val:function(){return O},WMv:function(){return C},XDk:function(){return pt},Ylh:function(){return st},ZGq:function(){return $},_2j:function(){return v},__d:function(){return xt},_jD:function(){return dt},abZ:function(){return I},asn:function(){return A},brp:function(){return J},cU0:function(){return K},dOV:function(){return h},drH:function(){return yt},dwx:function(){return lt},f$V:function(){return D},fj3:function(){return w},g6T:function(){return Y},gQb:function(){return k},gqw:function(){return q},hxn:function(){return Q},hyo:function(){return X},iGb:function(){return G},iql:function(){return et},k4s:function(){return Tt},kbn:function(){return B},nAK:function(){return p},p$g:function(){return gt},q$n:function(){return R},qC0:function(){return _},rBC:function(){return _t},s4z:function(){return Rt},sHT:function(){return M},sRQ:function(){return o},tuu:function(){return W},v0m:function(){return mt},vJ6:function(){return L},xg2:function(){return rt},yhe:function(){return V},zXm:function(){return wt},zy3:function(){return T}});var n=e(6306),r="the user cancels the stream request.",s={code:1000002,message:"not login room"},u={code:1000014,message:"stream ID is too long"},o={code:1000015,message:"streamID is empty"},c={code:1000016,message:"stream ID contains illegal characters"},h={code:1000017,message:n.Fq},a={code:1000018,message:n.Qx},f={code:1100001,message:n.v4},d={code:1100002,message:"network timeout."},l={code:1100999,message:"unknown server error"},m={code:1101005,message:"signal hb fail"},v={code:1002014,msg:n.E3},p={code:1102017,message:"dispatch error"},g={code:1102018,message:"token expired"},b={code:1102021,message:"biz channel error."},E={code:1102022,message:"dispatch request timeout"},I={code:1102024,message:"invalid channel"},y={code:1003025,message:"stream is forbided by media server"},_={code:1003050,message:"extra info of publishing stream is null"},D={code:1103001,message:n.v4},w={code:1103002,message:"browser do not support"},S={code:1103010,message:"screen fail"},C={code:1103011,message:"enumerate devices fail"},R={code:1103021,message:"session request fail"},T={code:1103022,message:"create offer error"},V={code:1103023,message:"setLocalDescription error"},x={code:1103024,message:"mediaDesc error"},z={code:1103025,message:"other side offer error"},N={code:1103026,message:"candidate error"},O={code:1103027,message:"server session closed"},M={code:1103028,message:"ice connection error"},H={code:1103030,message:"negotiation timeout"},P={code:1103042,message:"screen canceled"},k={code:1103043,message:"screen not support"},L={code:1103044,message:n.b0},A={code:1103099,message:"stream is not capturing"},j={code:1103049,message:"repeated pull same stream"},U={code:1103050,message:"websocket disconnected"},q={code:1103051,message:"publisher retry timeout"},F={code:1103053,message:"https is required"},G={code:1103055,message:n.eW},B={code:1103056,message:"publish is publishing"},Q={code:1103058,message:"client ip changed"},Z={code:1103059,message:"ttl over time"},K={code:1103060,message:"session request timeout"},W={code:1103061,message:"get media fail"},J={code:1103062,message:"update stream info fail"},X={code:1103063,message:"publish target no response"},Y={code:1103064,message:"get device not allowed"},$={code:1103065,message:"device is not readable"},tt={code:1103066,message:"device does not meet constraints"},it={code:1103067,message:"update sdp time out"},et={code:1103068,message:"update sdp fail"},nt={code:1103073,message:"video effect is starting, please operate after video effect is started"},rt={code:1103078,message:"publish stream poor and net probe poor"},st={code:1103089,message:r},ut={code:1104001,message:"input parm error"},ot={code:1104021,message:"session request fail"},ct={code:1104022,message:"create offer error"},ht={code:1104023,message:"setLocalDescription error"},at={code:1104024,message:"mediaDesc error"},ft={code:1104025,message:"other side offer error"},dt={code:1104026,message:"candidate error"},lt={code:1104027,message:"server session closed"},mt={code:1104028,message:"ice connection error"},vt={code:1104029,message:"websocket disconnected"},pt={code:1104030,message:"negotiation timeout"},gt={code:1104031,message:"player retry timeout"},bt={code:1104032,message:"player is playing"},Et={code:1104033,message:"client ip changed"},It={code:1104034,message:"ttl is over time"},yt={code:1104035,message:"reset session push"},_t={code:1104036,message:"session request timeout"},Dt={code:1104037,message:"probe time out"},wt={code:1104038,message:"resource mode is not supported"},St={code:1104039,message:"play stream not found"},Ct={code:1104041,message:"stream quality poor and net probe poor"},Rt={code:1104042,message:r},Tt={code:1104043,message:"mini sdp error"},Vt={code:1103057,message:"decode audio data fail"},xt={code:1103100,message:"background process is start, but not subscribe yet"}},5245:function(t,i,e){"use strict";e.d(i,{Gp:function(){return s}});var n=e(1945),r=e(4747),s={event:"/sdk/create_stream",error:{i:n.fj3,u:n.f$V,h:n.QQV,l:n.FfT,m:n.gQb,v:n.E_F,p:n.tuu,g:n.g6T,_:n.ZGq,D:n.JkR},stream_type:r.DX,screen:r.rV,camera:r.rV,custom:r.rV,preview_conf:r.rV,media_stream_id:r.DX}},4747:function(t,i,e){"use strict";e.d(i,{DX:function(){return r},Fs:function(){return s},V2:function(){return o},g1:function(){return u},rV:function(){return n}});var n=function(t){return t},r=function(t){return t},s=function(t){return t},u=function(t){return t},o=function(t){return t}},5341:function(t,i,e){"use strict";e(3873),e(5245),e(1945)},6306:function(t,i,e){"use strict";e.d(i,{$E:function(){return v},Au:function(){return r},E3:function(){return a},Fq:function(){return g},G6:function(){return o},GJ:function(){return n},Oy:function(){return h},Qx:function(){return m},b0:function(){return d},bq:function(){return c},eW:function(){return p},ij:function(){return s},v4:function(){return l},wM:function(){return f}});e(3720),e(1945);var n=Promise,r=document;function s(){return navigator.userAgent||""}function u(){var t,i=navigator.userAgent,e=i.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*([\d\.]+)/i)||[];return/trident/i.test(e[1])?{name:"IE",version:(t=/\brv[ :]+([\d\.]+)/g.exec(i)||[])[1]||""}:"Chrome"===e[1]&&null!=(t=i.match(/\bOPR|Edge\/([\d\.]+)/))?{name:"Opera",version:t[1]}:(e=e[2]?[e[1],e[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=i.match(/version\/([\d+\.]+)/i))&&e.splice(1,1,t[1]),{name:e[0],version:e[1]})}function o(){return"safari"==u().name.toLowerCase()}function c(t,i,e){void 0===e&&(e=""),t.info("".concat(i," call ").concat(e))}function h(t,i,e){void 0===e&&(e=""),t.info("".concat(i," success ").concat(e))}var a="room not exist",f="device is not found",d="stream is not from zego",l="input param error",m="local stream wrong",v="no preview",p="publish stream no found",g="network is broken"},2428:function(t,i,e){"use strict";e.d(i,{t:function(){return u}});var n=e(3873),r=e(9399),s=function(t,i,e){if(e||2===arguments.length)for(var n,r=0,s=i.length;r<s;r++)!n&&r in i||(n||(n=Array.prototype.slice.call(i,0,r)),n[r]=i[r]);return t.concat(n||Array.prototype.slice.call(i))},u=function(){function t(){}return t.zegoSdp=function(t){var i=t.split("\r\n"),e=[],n=[];i.forEach((function(t){var i=t.match(/a=rtpmap:(\d+)\s+((H264\/90000)|(opus\/48000\/2))/);i&&i[1]&&i[2]&&("H264/90000"===i[2]&&e.push(i[1]),"opus/48000/2"===i[2]&&n.push(i[1]))}));var r=[];return i.map((function(t){var i=!0,u=t.match(/((a=rtcp-fb:)|(a=rtpmap:)|(a=fmtp:))(\d+)/);if(u&&u[5]&&(s(s([],e,!0),n,!0).some((function(t){return t==u[5]}))||(i=!1)),t.indexOf("m=video")>-1){var o=t.split(" ");t=s([o[0],o[1],o[2]],e,!0).join(" ")}else if(t.indexOf("m=audio")>-1){o=t.split(" ");t=s([o[0],o[1],o[2]],n,!0).join(" ")}i&&r.push(t)})),r.join("\r\n")},t.getSDPByVideDecodeType=function(t,i,e,u){var o={str:"",arr:[],obj:{H264:[],H265:[],VP8:[],VP9:[],OTHER:[]}};if(!t.includes("m=video"))return t;var c=/m=video.+/.exec(t)[0];c=c.match(/[\s|\d]+/g)[1].replace(" ",""),o.str=c,o.arr=o.str.split(" "),o.arr.forEach((function(i){var e=new RegExp("a=rtpmap:"+i+".+").exec(t)[0];e.includes("H264")?o.obj.H264.push(i):e.includes("H265")?o.obj.H265.push(i):e.includes("VP8")?o.obj.VP8.push(i):e.includes("VP9")?o.obj.VP9.push(i):o.obj.OTHER.push(i)})),o.obj.OTHER.forEach((function(i){var e=new RegExp("a=fmtp:"+i+".+apt=(\\d+)").exec(t),n=e&&e[1];n&&(o.obj.H264.includes(n)?o.obj.H264.push(i):o.obj.H265.includes(n)?o.obj.H265.push(i):o.obj.VP8.includes(n)?o.obj.VP8.push(i):o.obj.VP9.includes(n)&&o.obj.VP9.push(i))}));var h=[];if("VP9"===i?h=s(s(s([],o.obj.H265,!0),o.obj.H264,!0),o.obj.VP8,!0):"VP8"===i?h=s(s(s([],o.obj.H265,!0),o.obj.H264,!0),o.obj.VP9,!0):"H264"===i?h=s(s(s([],o.obj.H265,!0),o.obj.VP8,!0),o.obj.VP9,!0):"H265"===i&&(h=s(s(s([],o.obj.VP8,!0),o.obj.H264,!0),o.obj.VP9,!0)),"H264"==i&&(0,r.ZV)(e)){var a=function(t){return function(i){return!!i.includes("profile-level-id=")&&(t?!i.includes("profile-level-id=42e01f"):i.includes("profile-level-id=42e01f"))}},f=function(t){return function(i){if(!i.includes("profile-level-id="))return!1;switch(t){case n.lq.BASE_LINE:return!i.includes("profile-level-id=42");case n.lq.MAIN:return!i.includes("profile-level-id=4d");case n.lq.HIGH:return!i.includes("profile-level-id=64");default:return!1}}},d=function(i){return function(){var e=[];return o.obj.H264.forEach((function(n){for(var r=new RegExp("a=fmtp:"+n+".+\\s\\n","g").exec(t)||[],s=0,u=i;s<u.length;s++){0!==r.filter(u[s]).length&&e.push(n)}var o=new RegExp("a=fmtp:"+n+".+apt=(\\d+)").exec(t),c=o&&o[1];c&&e.includes(c)&&e.push(n)})),e}};h=h.concat(function(){for(var t=[],i=0,s=(0,r.Qo)(u)||u!==n.ds.HARD_SOFT_ENCODEC_FIRST?(0,r.Qo)(u)||u!==n.ds.HIGH_PROFILE_FIRST?[d([f(n.lq.BASE_LINE),a(e)]),d([f(n.lq.BASE_LINE),a(!e)]),d([a(e)]),d([a(!e)])]:[d([f(n.lq.HIGH),a(e)]),d([f(n.lq.HIGH),a(!e)]),d([a(e)]),d([a(!e)])]:[d([a(e),f(n.lq.BASE_LINE)]),d([a(e)]),d([a(!e),f(n.lq.BASE_LINE)]),d([a(!e)])];i<s.length;i++){if(t=(0,s[i])(),new Set(t).size!==o.obj.H264.length)break;t=[]}return t}())}return h.forEach((function(i){var e=o.arr.indexOf(i);e>=0&&o.arr.splice(e,1);var n=new RegExp("a=rtpmap:"+i+".+\\s\\n","g"),r=new RegExp("a=rtcp-fb:"+i+".+\\s\\n","g"),s=new RegExp("a=fmtp:"+i+".+\\s\\n","g");t=(t=(t=t.replace(n,"")).replace(r,"")).replace(s,"")})),t=t.replace(c,o.arr.join(" "))},t}()},9399:function(t,i,e){"use strict";function n(t){return"number"==typeof t}function r(t){return"string"==typeof t}function s(t){return"boolean"==typeof t}function u(t){return void 0===t}function o(t){return"function"==typeof t}function c(t){return t instanceof MediaStream}function h(t){return t instanceof HTMLMediaElement}function a(t){return t instanceof ArrayBuffer}e.d(i,{Qo:function(){return u},Rk:function(){return r},UH:function(){return n},W8:function(){return a},ZF:function(){return h},ZV:function(){return s},ae:function(){return o},gE:function(){return c}})},248:function(t,i,e){"use strict";e.d(i,{Zp:function(){return n.Z}});e(5245),e(1299),e(5341),e(6306),e(9399);var n=e(568)},568:function(t,i,e){"use strict";e.d(i,{Z:function(){return r}});var n=e(9399);function r(t,i){if(t&&!(0,n.gE)(t)&&t.zegoStream){if(i.info("cu.gs type:zego"),(0,n.gE)(t.stream))return t.stream;throw new Error("The ZegoLocalStream type requires first calling the capture api to capture the stream")}return t}},1299:function(t,i,e){"use strict";e.d(i,{V:function(){return c}});var n=e(9399),r=e(2428),s=e(6306),u=function(t,i,e,n){return new(e||(e=Promise))((function(r,s){function u(t){try{c(n.next(t))}catch(t){s(t)}}function o(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var i;t.done?r(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(u,o)}c((n=n.apply(t,i||[])).next())}))},o=function(t,i){var e,n,r,s,u={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(u=0)),u;)try{if(e=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(r=u.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){u.label=o[1];break}if(6===o[0]&&u.label<r[1]){u.label=r[1],r=o;break}if(r&&u.label<r[2]){u.label=r[2],u.ops.push(o);break}r[2]&&u.ops.pop(),u.trys.pop();continue}o=i.call(t,u)}catch(t){o=[6,t],n=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},c=function(){function t(){var t=this;this.iceconnectionstatechangeTimes=0,this.isCheckAll=!1;var i=s.Au.createElement("canvas");i.getContext("2d").fillStyle="rgba(255, 255, 255, 0)";try{this.localStream=i.captureStream()}catch(t){console.error("canvas captureStream error",t)}this.timer=setTimeout((function(){t.resolve("Detection timeout"),t.hangup()}),5e3)}return t.prototype.checkSupportByType=function(t,i){return u(this,void 0,void 0,(function(){var i,e,n=this;return o(this,(function(r){switch(r.label){case 0:return this.checkType=t,i={},this.localPc=new RTCPeerConnection(i),this.remotePc=new RTCPeerConnection(i),e=new s.GJ((function(t){return n.resolve=t})),this.localPc.addEventListener("icecandidate",(function(t){return n.onIceCandidate(n.localPc,t)})),this.remotePc.addEventListener("icecandidate",(function(t){return n.onIceCandidate(n.remotePc,t)})),this.remotePc.addEventListener("iceconnectionstatechange",(function(i){"connected"===n.remotePc.iceConnectionState&&(n.iceconnectionstatechangeResult=!0),2==++n.iceconnectionstatechangeTimes&&n.iceCandidate&&(clearTimeout(n.timer),n.resolve("connected"===n.remotePc.iceConnectionState||"The browser does not support ".concat(t," format")),n.hangup())})),this.localStream.getTracks().forEach((function(t){return n.localPc.addTrack(t,n.localStream)})),[4,this.check(t)];case 1:return r.sent(),[4,e];case 2:return[2,r.sent()]}}))}))},t.prototype.check=function(t,i){return u(this,void 0,void 0,(function(){var e,s;return o(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),i&&(0,n.ae)(this.localPc.addTransceiver)&&(this.localPc.addTransceiver("video",{direction:"sendonly"}),this.localPc.addTransceiver("audio",{direction:"sendonly"})),[4,this.localPc.createOffer({offerToReceiveAudio:!0,offerToReceiveVideo:!0})];case 1:return(e=u.sent()).sdp=r.t.getSDPByVideDecodeType(e.sdp,t),this.onCreateOfferSuccess(e),[3,3];case 2:return s=u.sent(),this.onCreateSessionDescriptionError(s),[3,3];case 3:return[2]}}))}))},t.prototype.onCreateOfferSuccess=function(t){return u(this,void 0,void 0,(function(){var i,e,n,r;return o(this,(function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,this.localPc.setLocalDescription(t)];case 1:return s.sent(),[3,3];case 2:return i=s.sent(),this.onSetSessionDescriptionError(i),[2];case 3:return s.trys.push([3,5,,6]),[4,this.remotePc.setRemoteDescription(t)];case 4:return s.sent(),[3,6];case 5:return e=s.sent(),this.onSetSessionDescriptionError(e),[2];case 6:return s.trys.push([6,9,,10]),[4,this.remotePc.createAnswer()];case 7:return n=s.sent(),[4,this.onCreateAnswerSuccess(n)];case 8:return s.sent(),[3,10];case 9:return r=s.sent(),this.onCreateSessionDescriptionError(r),[2];case 10:return[2]}}))}))},t.prototype.onCreateAnswerSuccess=function(t){return u(this,void 0,void 0,(function(){var i,e;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.remotePc.setLocalDescription(t)];case 1:return n.sent(),[3,3];case 2:return i=n.sent(),this.onSetSessionDescriptionError(i),[2];case 3:return n.trys.push([3,5,,6]),[4,this.localPc.setRemoteDescription(t)];case 4:return n.sent(),[3,6];case 5:return e=n.sent(),this.onSetSessionDescriptionError(e),[2];case 6:return[2]}}))}))},t.prototype.onIceCandidate=function(t,i){return u(this,void 0,void 0,(function(){var e;return o(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,this.getOtherPc(t).addIceCandidate(i.candidate)];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),console.error(this.checkType,"".concat(this.getPcName(t)," addIceCandidate error"),e),clearTimeout(this.timer),this.hangup(),this.resolve(e),[3,3];case 3:return"remotePc"===this.getPcName(t)&&i.candidate&&(this.iceCandidate=!0),this.iceconnectionstatechangeResult&&"localPc"===this.getPcName(t)&&(clearTimeout(this.timer),this.hangup(),this.resolve(!0)),[2]}}))}))},t.prototype.getOtherPc=function(t){return t===this.localPc?this.remotePc:this.localPc},t.prototype.getPcName=function(t){return t===this.localPc?"localPc":"remotePc"},t.prototype.onCreateSessionDescriptionError=function(t){console.error("Failed to create session description: ".concat(t.toString())),clearTimeout(this.timer),this.hangup(),this.resolve(t)},t.prototype.onSetSessionDescriptionError=function(t){console.error("Failed to set session description: ".concat(t.toString())),clearTimeout(this.timer),this.hangup(),this.resolve(t)},t.prototype.hangup=function(){this.localPc.close(),this.remotePc.close(),this.iceconnectionstatechangeTimes=0,this.localStream.getTracks().forEach((function(t){return t.stop()}))},t}()},4119:function(i){"use strict";i.exports=t}},e={};function n(t){var r=e[t];if(void 0!==r)return r.exports;var s=e[t]={exports:{}};return i[t](s,s.exports,n),s.exports}n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,{a:i}),i},n.d=function(t,i){for(var e in i)n.o(i,e)&&!n.o(t,e)&&Object.defineProperty(t,e,{enumerable:!0,get:i[e]})},n.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var r={};return function(){"use strict";n.r(r),n.d(r,{AudioMix:function(){return T}});var t="zc.pe.0",i="zc.pe.1",e="zc.aep",s="zc.sev",u="zc.sma.0",o="zc.sma.1",c="zc.mb",h="zc.smb",a="zc.p.0.pe.0",f="zc.p.0.pe.1",d="zc.p.0.re",l="zc.p.0.se",m="zc.p.0.sma.0",v="zc.smav",p="zc.p.0.mb",g="zc.p.0.smav",b=n(1945),E=function(){function t(t,i,e,n,r){this.S=t,this.ac=i,this.localStream=e,this.destination=n,this.rtcViewer=r,this.audioBufferList=[],this.replace=!1,this.effectEndedCallBack=null,this.effectEndedListener=null,this.startTimes=0,this.startOffset=0,this.pauseTimes=0,this.resumeOffset=0,this.paused=!1,this.isMixAudio=!1,this.isMixingBuffer=!1,this.loop=!1}return t.prototype.playEffect=function(t,i,e,n,r){var s=this;!0!==this.isMixAudio?this.audioBuffer?(this.startOffset=t||0,this.loop=i||!1,this.replace=e||!1,this.effectEndedCallBack=r,this.mixEffect(this.audioBuffer,(function(){s.buffSource.loop=!!i,t?s.buffSource.start(0,t/1e3):s.buffSource.start(0),s.startTimes=Date.now(),s.effectEndedListener=s.effectEndedHandler.bind(s),s.buffSource.addEventListener("ended",s.effectEndedListener),n&&n()}))):this.S.error("amu.pe.1 no audio buffer found"):this.S.warn("amu.pe.1 audio is mixing")},t.prototype.stopMixingBuffer=function(){return this.isMixingBuffer=!1,this.stopMixingAudio()},t.prototype.playRealTimeEffect=function(t){var i=this;this.mixEffect(t,(function(){i.buffSource&&i.buffSource.start(0),i.buffSource&&i.buffSource.addEventListener("ended",(function(){i.audioBufferList.shift(),i.audioBufferList.length>0&&i.isMixAudio&&i.playRealTimeEffect(i.audioBufferList[0])}))}))},t.prototype.pauseEffect=function(){this.audioBufferList.length>0?this.S.error("amu.pe.0 real time buffer can not be paused"):(this.stopMixingAudio(!0),this.resumeOffset=(this.pauseTimes-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration),this.paused=!0)},t.prototype.resumeEffect=function(){return this.audioBufferList.length>0?(this.S.error("amu.pe.0 real time buffer can not be resume"),!1):(this.playEffect(this.resumeOffset,this.loop,this.replace,void 0,this.effectEndedCallBack),this.startOffset=this.resumeOffset,this.paused=!1,!0)},t.prototype.mixEffect=function(t,i){this.localStream?(this.ac.resume(),this.gainNode=this.ac.createGain(),this.delayNode=this.ac.createDelay(1),this.delayNode.delayTime.value=0,this.buffSource=this.ac.createBufferSource(),this.buffSource.buffer=t,this.buffSource.connect(this.gainNode),this.gainNode.connect(this.ac.destination),this.replaceTrack()&&i()):this.S.error("amu.me.0 localStream can not be found")},t.prototype.replaceTrack=function(){if(!this.destination)return!1;this.gainNode.connect(this.delayNode),this.delayNode.connect(this.destination);var t=this.destination.stream.getAudioTracks()[0],i=this.localStream.getTracks();return this.micTrack=this.localStream.getAudioTracks()[0],this.micTrack!==t&&(this.micTrack?i.includes(this.micTrack)&&this.localStream.removeTrack(this.micTrack):this.S.warn("amu.rt.0 origin track not fonud"),i.includes(t)||(this.localStream.addTrack(t),this.rtcViewer&&this.rtcViewer.setAudio(t))),this.isMixAudio=!0,!0},t.prototype.effectEndedHandler=function(){this.stopMixingAudio(),this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null},t.prototype.stopMixingAudio=function(t){return void 0===t&&(t=!1),this.paused?(this.S.info("amu.sma.1 audioEffect is paused"),!t&&this.effectEndedListener&&(this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null),!0):this.isMixAudio?this.localStream?(this.buffSource&&(this.buffSource.removeEventListener("ended",this.effectEndedListener),this.buffSource.stop(),this.pauseTimes=Date.now(),this.buffSource.disconnect(this.gainNode),this.buffSource=null),this.gainNode.disconnect(),this.delayNode.disconnect(),this.isMixAudio=!1,this.audioBufferList=[],!t&&this.effectEndedListener&&(this.effectEndedCallBack&&this.effectEndedCallBack(),this.effectEndedCallBack=null),!0):(this.S.error("amu.sma.1 localStream can not be found"),!1):(this.S.warn("amu.sma.1 no mixing audio found"),!0)},t.prototype.getProcess=function(){var t=Date.now();return this.paused&&(t=this.pauseTimes),(t-this.startTimes+this.startOffset)%(1e3*this.audioBuffer.duration)},t.prototype.seekTo=function(t){void 0===t&&(t=0),this.startOffset=t,this.paused?this.resumeOffset=t:(this.stopMixingAudio(!0),this.playEffect(t,this.loop,this.replace,void 0,this.effectEndedCallBack))},t.prototype.mixingBuffer=function(t,i){var e=this;!0!==this.isMixAudio||0!=this.audioBufferList.length||0!=this.isMixingBuffer?(this.ac.resume(),this.ac.decodeAudioData(t,(function(t){e.audioBufferList.push(t),1==e.audioBufferList.length&&e.playRealTimeEffect(e.audioBufferList[0]),e.isMixingBuffer=!0,i&&i()}),(function(t){e.S.error("amu.mb.0 "+t),i&&i({code:b.IAb.code,message:b.IAb.message+" "+t})}))):this.S.error("amu.mb.0 audio is mixing")},t.prototype.setMixingAudioVolume=function(t){return this.gainNode?(console.error("ktv setVolume",t),this.gainNode.gain.value=t,!0):(this.S.error("amu.sma.2 no mixing audio found"),!1)},t.prototype.setDelay=function(t){return this.delayNode?(this.S.info("amu.sma.2 set delay: "+t),this.delayNode.delayTime.value=t,!0):(this.S.warn("amu.sma.2 no mixing audio found"),!1)},t}(),I=n(6306),y=function(){function t(t,i,e,n,r,s,u){void 0===u&&(u=1);var o=this;this.S=t,this.acMgr=i,this.localStream=e,this.browser=n,this.destination=r,this.rtcViewer=s,this.volumeFactor=u,this.isMixAudio=!1,this.maxDelay=1,this.audioCurrentTimer=null,this.audioResumedTimer=null,this.audioEl=null,this.eventHandler={volumechange:function(t){var i=t.target;i&&o.audioNode&&o.isMediaElSrc&&(i.muted||i.paused?(o.S.info("amu.sma.0 ".concat(o.id," audio muted disconnect")),o.audioNode.disconnect()):(o.S.info("amu.sma.0 ".concat(o.id," audio is connected")),o.audioNode.connect(o.gainNode)))},canplay:function(t){var i=t.target;i&&!o.isMediaElSrc&&o.isMixAudio&&(o.S.info("amu.sma.1 ".concat(o.id," canplay, remixing audio")),o.stopMixingAudio(),o.startMixingAudio(i))}},this.isMediaElSrc=!1,this.volume=1,this.delay=0,this.id=Date.now()%1e5+Math.floor(10*Math.random()),t.info("amu.sma.0 ".concat(this.id," init audio mix"))}return Object.defineProperty(t.prototype,"ac",{get:function(){return this.acMgr.ac},enumerable:!1,configurable:!0}),t.prototype.startMixingAudio=function(t){if(this.isMixAudio)return this.S.error("amu.sma.0 audio is mixing"),!1;if(!this.localStream)return this.S.error("amu.sma.0 localStream can not be found"),!1;var i;t.captureStream=t.captureStream||t.mozCaptureStream||t.webkitCaptureStream,this.isMixAudio=!0,this.gainNode||(this.gainNode=this.ac.createGain(),this.setMixingAudioVolume()),this.delayNode||(this.delayNode=this.ac.createDelay(this.maxDelay),this.S.info("amu.sma.1 ".concat(this.id," init set delay: ")+this.delay),this.delayNode.delayTime.value=this.delay);var e="safari"===this.browser;this.isMediaElSrc=!0;try{var n=this.acMgr.getMediaElementRenderer(t);if(!n)return!1;this.audioNode=n.getMixNode().mixOutputNode,this.audioEl=t}catch(t){i=t}t.addEventListener("volumechange",this.eventHandler.volumechange),t.addEventListener("pause",this.eventHandler.volumechange),t.addEventListener("play",this.eventHandler.volumechange);var r=this.getBrowserInfo(),s=!1;return e&&"10.15.6"===(null==r?void 0:r.sysVer)&&"13.1.2"===(null==r?void 0:r.ver)&&(s=!0),s&&(this.audioResumedTimer=setInterval((function(){t.currentTime=t.currentTime+.45}),6e3)),i?(this.S.info("amu.sma.1 ".concat(this.id," create source failed: ")+i),!0):(this.audioNode.connect(this.gainNode),this.S.info("amu.sma.1 ".concat(this.id," mix audio success.")),this.replaceTrack())},t.prototype.getBrowserInfo=function(){var t,i={},e=(0,I.ij)().toLowerCase();t=(e.match(/x [\d._]+/gi)+"").replace(/[^0-9|_.]/gi,"").replace(/_/gi,"."),i.sysVer=t;var n=e.match(/(msie|firefox|chrome|opera|version).*?([\d.]+)/);return n&&(i.browser=n[1].replace(/version/,"'safari"),i.ver=n[2]),i},t.prototype.replaceTrack=function(){if(!this.destination)return!1;this.gainNode.connect(this.delayNode),this.delayNode.connect(this.destination);var t=this.destination.stream.getAudioTracks()[0],i=this.localStream.getTracks();return this.micTrack=this.localStream.getAudioTracks()[0],this.micTrack!==t&&(this.micTrack?i.includes(this.micTrack)&&this.localStream.removeTrack(this.micTrack):this.S.warn("amu.rt.1 origin track not fonud"),i.includes(t)||(this.localStream.addTrack(t),this.rtcViewer&&this.rtcViewer.setAudio(t))),!0},t.prototype.stopMixingAudio=function(){return this.isMixAudio?this.localStream?(this.audioEl&&(this.audioEl.removeEventListener("volumechange",this.eventHandler.volumechange),this.audioEl.removeEventListener("pause",this.eventHandler.volumechange),this.audioEl.removeEventListener("play",this.eventHandler.volumechange),this.audioEl.removeEventListener("canplay",this.eventHandler.canplay),this.audioEl=null),this.audioNode&&(this.audioNode.disconnect(),this.audioNode=null,this.audioCurrentTimer&&(clearInterval(this.audioCurrentTimer),this.audioCurrentTimer=null),this.audioResumedTimer&&(clearInterval(this.audioResumedTimer),this.audioResumedTimer=null)),this.gainNode.disconnect(),this.delayNode.disconnect(),this.isMixAudio=!1,this.S.info("amu.sma.1 ".concat(this.id," stop mix audio success.")),!0):(this.S.error("amu.sma.1 localStream can not be found"),!1):(this.S.warn("amu.sma.1 no mixing audio found"),!0)},t.prototype.setMixingAudioVolume=function(t,i){if(void 0===t?t=this.volume:this.volume=t,void 0===i?i=this.volumeFactor:this.volumeFactor=i,!this.gainNode)return this.S.error("amu.sma.2 no mixing audio found"),!1;var e=t*this.volumeFactor;return this.S.info("amu.sma.2 "+this.id+" set volume: "+e),this.gainNode.gain.value=e,!0},t.prototype.setDelay=function(t){return this.delayNode?(t/=1e3,!isNaN(t)&&(t>this.maxDelay&&(t=this.maxDelay),t<0&&(t=0),this.S.info("amu.sma.1 ".concat(this.id," set delay: ")+t),this.delayNode.delayTime.value=t,this.delay=t,!0)):(this.S.warn("amu.sma.1 no mixing audio found"),!1)},t}(),_=n(9399),D=function(){function t(t){this.C=t,this.audioDestNode=void 0,this._audioMixList=[],this._arrayBufferMap={},this._effectList=[],this.volumeFactor=1}return Object.defineProperty(t.prototype,"delay",{get:function(){return this.R.engineConfig.mixingAudioDelay+this.R.engineConfig.baseMixingAudioDelay},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"S",{get:function(){return this.C.logger},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_localStream",{get:function(){return this.C.localStream},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"T",{get:function(){return this.C.streamCenter},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"R",{get:function(){return this.C.stateCenter},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ac",{get:function(){return this.acMgr.ac},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"acMgr",{get:function(){return this.C.acMgr},enumerable:!1,configurable:!0}),t.prototype.startMixingAudio=function(t){var i=this;if(this.S.info(m+" call"),!this._localStream)return this.S.error(m+" localStream not found"),!1;var e=!0;return t.forEach((function(t){if(i._audioMixList.find((function(i){return i.media==t})))i.S.warn(m+" mix audio already exist");else if(i._localStream){i.T.soundLevelDelegate&&i.C.stopSoundLevel();var n=i.createDestNode(),r=new y(i.S,i.acMgr,i._localStream,i.R.browser,n,i.C.rtcViewer,i.volumeFactor);i._audioMixList.push({audioMix:r,media:t}),r.startMixingAudio(t)||(e=!1),r.setDelay(i.delay),i.T.soundLevelDelegate&&i.C.startSoundLevel()}})),e},t.prototype.stopMixingAudio=function(t){var i=this;return this.S.info("zc.p.0.sma.1 call"),t?t.forEach((function(t){for(var e=0;e<i._audioMixList.length;e++)if(i._audioMixList[e].media==t){i._audioMixList[e].audioMix.stopMixingAudio()&&i._audioMixList.splice(e--,1);break}})):(this._audioMixList.forEach((function(t){return t.audioMix.stopMixingAudio()})),this._audioMixList=[]),!0},t.prototype.setVolumeFactor=function(t){this.S.info(g+" set factor: "+t),isNaN(t)&&this.S.error(g+" set factor failed"),this.volumeFactor=t,this._audioMixList.forEach((function(i){i.audioMix.setMixingAudioVolume(void 0,t)}))},t.prototype.setMixingAudioVolume=function(t,i){this.S.info(g+" call");var e=this._audioMixList.find((function(t){return t.media===i}));return e?(e.audioMix.setMixingAudioVolume(t),this.S.info(g+" call success"),!0):(this.S.error(g+" audio is not mixing"),!1)},t.prototype.playEffect=function(t,i,e,n){var r=this;if(this.S.info(a+" call"),this._localStream)if(this._effectList.find((function(e){return e.effectID==t.effectID&&e.audioBuffer==i})))this.S.warn(a+" effect already exist ");else{this.T.soundLevelDelegate&&this.C.stopSoundLevel();var s=this.createDestNode(),u=new E(this.S,this.ac,this._localStream,s,this.C.rtcViewer);u.audioBuffer=i;var o={processor:u,effectID:t.effectID,audioBuffer:i};this._effectList.push(o);u.playEffect(t.playTime,t.loop,!1,(function(){e&&e()}),(function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];r._effectList=r._effectList.filter((function(t){return t!==o})),n&&n.apply(void 0,t)})),this.T.soundLevelDelegate&&this.C.startSoundLevel(),this.S.info(a+" play effect "+t.effectID+" success")}else this.S.warn(a+" stream not found")},t.prototype.pauseEffect=function(t){var i=this._effectList.find((function(i){return i.effectID==t}));if(i)this.T.soundLevelDelegate&&this.C.stopSoundLevel(),i.processor.pauseEffect(),this.T.soundLevelDelegate&&this.C.startSoundLevel(),this.S.info(f+" pause "+t+" success");else{if(!(0,_.Qo)(t))return this.S.error(f+" effect not found"),!1;this.T.soundLevelDelegate&&this.C.stopSoundLevel(),this._effectList.forEach((function(t){return t.processor.pauseEffect()})),this.T.soundLevelDelegate&&this.C.startSoundLevel()}return!0},t.prototype.resumeEffect=function(t){var i=this._effectList.find((function(i){return i.effectID==t}));if(i){this.T.soundLevelDelegate&&this.C.stopSoundLevel();var e=i.processor.resumeEffect();return this.T.soundLevelDelegate&&this.C.startSoundLevel(),this.S.info(d+" resume "+t+" success"),e}return(0,_.Qo)(t)?(this.T.soundLevelDelegate&&this.C.stopSoundLevel(),this._effectList.forEach((function(t){return t.processor.resumeEffect()})),this.T.soundLevelDelegate&&this.C.startSoundLevel(),!0):(this.S.error(d+" no effect found"),!1)},t.prototype.stopEffect=function(t){var i=this._effectList.find((function(i){return i.effectID==t}));if(i)this.T.soundLevelDelegate&&this.C.stopSoundLevel(),i.processor.stopMixingAudio(),this._effectList=this._effectList.filter((function(t){return t!==i})),this.T.soundLevelDelegate&&this.C.startSoundLevel(),this.S.info(l+" pause "+t+" success");else{if(!(0,_.Qo)(t))return this.S.error(l+" effect not found"),!1;this.T.soundLevelDelegate&&this.C.stopSoundLevel(),this._effectList.forEach((function(t){return t.processor.stopMixingAudio()})),this._effectList=[],this.T.soundLevelDelegate&&this.C.startSoundLevel()}return!0},t.prototype.setEffectVolume=function(t,i,e){var n=this._effectList.find((function(t){return t.effectID==i}));if(n)n.processor.setMixingAudioVolume(t),n.processor.setDelay(e||1e-7),this.S.info("zp.sev.0 set volume "+i+" success");else{if(!(0,_.Qo)(i))return this.S.error("zp.sev.0 effect not found"),!1;this._effectList.forEach((function(i){return i.processor.setMixingAudioVolume(t)}))}return!0},t.prototype.mixingBuffer=function(t,i,e){var n=this;if(this.S.info(p+" call"),this._localStream)if(this._arrayBufferMap[t])this.T.soundLevelDelegate&&this.C.stopSoundLevel(),this._arrayBufferMap[t].mixingBuffer(i,(function(){n.T.soundLevelDelegate&&n.C.startSoundLevel(),e&&e()}));else{this.T.soundLevelDelegate&&this.C.stopSoundLevel();var r=this.createDestNode(),s=new E(this.S,this.ac,this._localStream,r,this.C.rtcViewer);this._arrayBufferMap[t]=s,s.mixingBuffer(i,(function(){n.T.soundLevelDelegate&&n.C.startSoundLevel(),e&&e()}))}},t.prototype.stopMixingBuffer=function(t){if(t&&this._arrayBufferMap[t])return this.T.soundLevelDelegate&&this.C.stopSoundLevel(),this._arrayBufferMap[t].stopMixingBuffer(),delete this._arrayBufferMap[t],this.T.soundLevelDelegate&&this.C.startSoundLevel(),!0;if((0,_.Qo)(t)){for(var i in this.T.soundLevelDelegate&&this.C.stopSoundLevel(),this._arrayBufferMap)this._arrayBufferMap[i].stopMixingBuffer();return this.T.soundLevelDelegate&&this.C.startSoundLevel(),!0}return this.S.warn(p+" arrayBuffer no found"),!1},t.prototype.getEffectProgress=function(t){var i=this._effectList.find((function(i){return i.effectID==t}));return i?i.processor.getProcess():(this.S.error(e+"  effect not found"),0)},t.prototype.seekAudioEffect=function(t,i){var n=this._effectList.find((function(i){return i.effectID==t}));return n?(this.T.soundLevelDelegate&&this.C.stopSoundLevel(),n.processor.seekTo(i),this.T.soundLevelDelegate&&this.C.startSoundLevel(),!0):(this.S.error(e+" effect not found"),!1)},t.prototype.stopAudioManager=function(){this.stopMixingAudio(),this.stopMixingBuffer(),this.stopEffect()},t.prototype.createDestNode=function(){var t=null,i=this.C.createDestNode(this._localStream);return this.C.audioNodeQueue||((t=this.C.createSrcNode()).disconnect(),t.connect(i)),i},t.prototype.setMixingDelay=function(t){this._audioMixList.forEach((function(i){i.audioMix.setDelay(t)}))},t}(),w=n(248),S=function(t,i,e,n){return new(e||(e=Promise))((function(r,s){function u(t){try{c(n.next(t))}catch(t){s(t)}}function o(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){var i;t.done?r(t.value):(i=t.value,i instanceof e?i:new e((function(t){t(i)}))).then(u,o)}c((n=n.apply(t,i||[])).next())}))},C=function(t,i){var e,n,r,s,u={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:o(0),throw:o(1),return:o(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function o(o){return function(c){return function(o){if(e)throw new TypeError("Generator is already executing.");for(;s&&(s=0,o[0]&&(u=0)),u;)try{if(e=1,n&&(r=2&o[0]?n.return:o[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,o[1])).done)return r;switch(n=0,r&&(o=[2&o[0],r.value]),o[0]){case 0:case 1:r=o;break;case 4:return u.label++,{value:o[1],done:!1};case 5:u.label++,n=o[1],o=[0];continue;case 7:o=u.ops.pop(),u.trys.pop();continue;default:if(!(r=u.trys,(r=r.length>0&&r[r.length-1])||6!==o[0]&&2!==o[0])){u=0;continue}if(3===o[0]&&(!r||o[1]>r[0]&&o[1]<r[3])){u.label=o[1];break}if(6===o[0]&&u.label<r[1]){u.label=r[1],r=o;break}if(r&&u.label<r[2]){u.label=r[2],u.ops.push(o);break}r[2]&&u.ops.pop(),u.trys.pop();continue}o=i.call(t,u)}catch(t){o=[6,t],n=0}finally{e=r=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}},R=function(){function n(t,i,e,n,r,s){var u=this;this.S=t,this.dataReport=i,this.R=e,this.T=n,this.ac=r,this.rtcModules=s,this.buffer=null,this.blank=null,this.mixingDelay=0,(0,I.G6)()&&null==this.blank&&null==this.buffer&&(this.buffer=this.ac.createBuffer(1,1,this.ac.sampleRate),this.blank=this.ac.createBufferSource(),this.blank.buffer=this.buffer,this.blank.connect(this.ac.destination),this.blank.start()),this.rtcModules.bindListener("_engineConfigUpdate",(function(t){var i=t.mixingAudioDelay+t.baseMixingAudioDelay;isNaN(i)||i===u.mixingDelay||(u.S.info("zc.am.mdu delay update:"+i+", origin:"+u.mixingDelay),u.mixingDelay=i,u.T.previewStreamList.forEach((function(t){t.audioMixManager&&t.audioMixManager.setMixingDelay(i)})))}))}return n.prototype.preloadEffect=function(i,e,n){if(this.checkPreviewer(t,{effectID:i},{effectID:!0}))if(e&&(0,_.Rk)(e)){if(this.R.audioEffectBuffer[i])return this.S.warn(t+" audio buffer already exists"),void(n&&n());this.S.info(t+" start preload effect"),this._preloadEffect(this.ac,i,e,n)}else this.S.error(t+" params error")},n.prototype.checkPreviewer=function(t,i,e){void 0===i&&(i={});var n=!!(null==e?void 0:e.effectID),r=!!(null==e?void 0:e.streamID),s=!!(null==e?void 0:e.previewer),u=i.effectID,o=i.streamID,c=o&&((0,_.Rk)(o)?o:(0,w.Zp)(o,this.S));if((r||c)&&!(0,_.Rk)(c)&&!(0,_.gE)(c))return this.S.error(t+" stream type error"),!1;if(n&&!u)return this.S.error(t+" effectID required"),!1;if(u&&!(0,_.Rk)(u))return this.S.error(t+" effectID type error"),!1;if(s){var h=this.T.getPreviewer(c);return h||((0,_.Rk)(c)?this.S.error(t+" "+c+" stream is not publishing"):this.S.error(t+" stream doesn't exist"),!1)}return!0},n.prototype.getEffectDuration=function(t){if(!this.checkPreviewer(e,{effectID:t},{effectID:!0}))return 0;var i=this.R.audioEffectBuffer[t];return i?i.duration?Math.floor(1e3*i.duration):0:(this.S.error(e+" effect not found"),0)},n.prototype.getEffectProgress=function(t,i){var n=this.checkPreviewer(e,{streamID:t,effectID:i},{effectID:!0,streamID:!0,previewer:!0});return(0,_.ZV)(n)?0:this.getAudioManager(n).getEffectProgress(i)},n.prototype.seekAudioEffect=function(t,i,n){if(n<0)return this.S.error(e+" param time error "),!1;var r=this.checkPreviewer(e,{streamID:t,effectID:i},{effectID:!0,streamID:!0,previewer:!0});return!(0,_.ZV)(r)&&this.getAudioManager(r).seekAudioEffect(i,n)},n.prototype.playEffect=function(t,e,n){return S(this,void 0,void 0,(function(){var r,s,u,o,c=this;return C(this,(function(h){switch(h.label){case 0:return r=(0,w.Zp)(t.stream,this.S)||t.streamID,s=t.path,this.checkPreviewer(i,{streamID:r,effectID:u=t.effectID},{streamID:!0,effectID:!0})?(o=this.R.audioEffectBuffer[u],s?o?(this.S.warn(i+" audio effect already exists"),[3,3]):[3,1]:[3,4]):[2];case 1:return[4,new I.GJ((function(t,e){c.preloadEffect(u,s,(function(n){n?(c.S.error(i+" preload audio effect failed"),e(n)):t(void 0)}))}))];case 2:h.sent(),h.label=3;case 3:return[3,5];case 4:if(!o)return this.S.error(i+" audio effect doesn't exists"),[2];h.label=5;case 5:return this._playEffect(t,e,n),[2]}}))}))},n.prototype.pauseEffect=function(t,i){var e=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S);return this._pauseEffect(e,i)},n.prototype.resumeEffect=function(t,i){var e=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S);return this._resumeEffect(e,i)},n.prototype.stopEffect=function(t,i){var e=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S);return this._stopEffect(e,i)},n.prototype.unloadEffect=function(t){return!!this.checkPreviewer("zc.ue",{effectID:t},{effectID:!0})&&(delete this.R.audioEffectBuffer[t],!0)},n.prototype.setEffectVolume=function(t,i,e,n){if(!(0,_.UH)(i)||i<0||i>200)return this.S.error(s+" volume must be a number between 0 and 200"),!1;var r=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S),u=this.checkPreviewer(s,{streamID:r,effectID:e},{streamID:!0,previewer:!0});return!(0,_.ZV)(u)&&this.getAudioManager(u).setEffectVolume(i/100,e,n)},n.prototype.startMixingAudio=function(t,i){var e=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S);return this.S.info(u+" call "+e),e?i?(this.S.info(u+" end "+e),Array.isArray(i)&&0!==i.length&&i.every((function(t){return(0,_.ZF)(t)}))?this.N(e,i):(this.S.error(u+" audio list param type error"),!1)):(this.S.error(u+" no audio"),!1):(this.S.error(u+" stream not found"),!1)},n.prototype.stopMixingAudio=function(t,i){var e=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S);return e?Array.isArray(i)&&0!==i.length||(0,_.Qo)(i)?this._stopMixingAudio(e,i):(this.S.error(o+" audio param type error"),!1):(this.S.error(o+" stream not found"),!1)},n.prototype.mixingBuffer=function(t,i,e,n){var r=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S);this.S.info(c+" call streamID: "+JSON.stringify(r)+" sourceID:"+i),r?i&&(0,_.Rk)(i)?(this._mixingBuffer(r,i,e,n),this.S.info(c+" end")):this.S.error(c+" param source id format error"):this.S.error(c+" param streamid format error")},n.prototype.stopMixingBuffer=function(t,i){var e=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S);return this._stopMixingBuffer(e,i)},n.prototype.setMixingAudioVolume=function(t,i,e){if(this.S.info(v+" call"),!t)return this.S.error(v+" stream not found"),!1;if(!(0,_.UH)(i)||i<0||i>200)return this.S.error(v+" volume must be a number between 0 and 200"),!1;if(!e||!(0,_.ZF)(e))return this.S.error(v+" no audio"),!1;var n=(0,_.Rk)(t)?t:(0,w.Zp)(t,this.S);return this._setMixingAudioVolume(n,i,e)},n.prototype.getSoundLevel=function(t,i,e){var n="zc.gsl";(0,I.bq)(this.S,n);var r=this.T.getCloudSoundInterval();try{var s=this.T.createSoundLevel(this.ac,t,this.T.soundLevelInterval,r,(function(t){i(t)}));this.R.audioStreamList[t.id]={mic:s.mic,script:s.soundMeter}}catch(t){e(t)}(0,I.Oy)(this.S,n)},n.prototype.stopSoundLevel=function(t){this.S.info("zc.ssl call");var i=this.R.audioStreamList[t.id];i.mic.disconnect(),i.script.destroy(),delete this.R.audioStreamList[t.id]},n.prototype._preloadEffect=function(t,i,e,n){var r=this,s=new XMLHttpRequest;s.open("GET",e,!0),s.setRequestHeader("Range","none"),s.responseType="arraybuffer",s.onload=function(){if(200==s.status||304==s.status){t.decodeAudioData(s.response,(function(t){r.S.info("zc.pe.0 effect '".concat(i,"' preload success")),r.R.audioEffectBuffer[i]=t,n&&n()}),(function(t){r.S.error("zc.pe.0 effect '".concat(i,"' preload fail. ")+t),n&&n(t)}))}else{var e=s.statusText;r.S.error("zc.pe.0 effect '".concat(i,"' preload fail.")+e),n&&n(e)}},s.send()},n.prototype._playEffect=function(t,e,n){var r=(0,w.Zp)(t.stream,this.S)||t.streamID,s=this.R.audioEffectBuffer[t.effectID];if(s){var u=this.checkPreviewer(i,{streamID:r,effectID:t.effectID},{streamID:!0,effectID:!0,previewer:!0});(0,_.ZV)(u)||this.getAudioManager(u).playEffect(t,s,e,n)}else this.S.error(i+" no audio buffer found")},n.prototype._pauseEffect=function(t,i){var e=this.checkPreviewer("zc.pe.2",{streamID:t,effectID:i},{streamID:!0,previewer:!0});return!(0,_.ZV)(e)&&this.getAudioManager(e).pauseEffect(i)},n.prototype._resumeEffect=function(t,i){var e=this.checkPreviewer("zc.re",{streamID:t,effectID:i},{streamID:!0,previewer:!0});return!(0,_.ZV)(e)&&this.getAudioManager(e).resumeEffect(i)},n.prototype._stopEffect=function(t,i){var e=this.checkPreviewer("zc.se",{streamID:t,effectID:i},{streamID:!0,previewer:!0});return!(0,_.ZV)(e)&&this.getAudioManager(e).stopEffect(i)},n.prototype._setMixingAudioVolume=function(t,i,e){var n=this.T.getPreviewer(t);return n?this.getAudioManager(n).setMixingAudioVolume(i/100,e):(this.S.error("zc.sma.2 publisher doesn't exist"),!1)},n.prototype.N=function(t,i){var e=this.T.getPreviewer(t);return e?this.getAudioManager(e).startMixingAudio(i):((0,_.Rk)(t)?this.S.error("zc.sma.0 "+t+" stream is not publishing"):this.S.error("zc.sma.0 stream doesn't exist"),!1)},n.prototype._stopMixingAudio=function(t,i){var e=this.T.getPreviewer(t);return e?this.getAudioManager(e).stopMixingAudio(i):(this.S.error("zc.sma.0 stream doesn't exist"),!1)},n.prototype._mixingBuffer=function(t,i,e,n){var r=this.checkPreviewer(h,{streamID:t,effectID:i},{effectID:!0,streamID:!0,previewer:!0});(0,_.ZV)(r)||((0,_.W8)(e)?this.getAudioManager(r).mixingBuffer(i,e,n):this.S.error("zc.mb.0 array buffer not found"))},n.prototype._stopMixingBuffer=function(t,i){var e=this.checkPreviewer(h,{streamID:t,effectID:i},{effectID:!0,streamID:!0,previewer:!0});return!(0,_.ZV)(e)&&this.getAudioManager(e).stopMixingBuffer(i)},n.prototype.getAudioManager=function(t){var i=t.audioMixManager;return i||(i=new D(t),1===this.R.engineConfig.choirRole&&i.setVolumeFactor(.6),t.audioMixManager=i),i},n}(),T={type:"AudioMix",install:function(t){Object.defineProperty(t.prototype,"initAudioMix",{value:function(){this.audioMixModule=new R(this.logger,this.dataReport,this.stateCenter,this.streamCenter,this.ac,this)}})}}}(),r}()}));