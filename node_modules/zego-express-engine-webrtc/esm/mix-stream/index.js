!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e(require("zego-express-engine-webrtm"));else if("function"==typeof define&&define.amd)define(["zego-express-engine-webrtm"],e);else{var r="object"==typeof exports?e(require("zego-express-engine-webrtm")):e(t["zego-express-engine-webrtm"]);for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}("undefined"!=typeof self?self:this,(function(__WEBPACK_EXTERNAL_MODULE__4119__){return function(){var __webpack_modules__={4537:function(t){"use strict";t.exports=function(t,e){var r=new Array(arguments.length-1),n=0,i=2,o=!0;for(;i<arguments.length;)r[n++]=arguments[i++];return new Promise((function(i,s){r[n]=function(t){if(o)if(o=!1,t)s(t);else{for(var e=new Array(arguments.length-1),r=0;r<e.length;)e[r++]=arguments[r];i.apply(null,e)}};try{t.apply(e||null,r)}catch(t){o&&(o=!1,s(t))}}))}},7419:function(t,e){"use strict";var r=e;r.length=function(t){var e=t.length;if(!e)return 0;for(var r=0;--e%4>1&&"="===t.charAt(e);)++r;return Math.ceil(3*t.length)/4-r};for(var n=new Array(64),i=new Array(123),o=0;o<64;)i[n[o]=o<26?o+65:o<52?o+71:o<62?o-4:o-59|43]=o++;r.encode=function(t,e,r){for(var i,o=null,s=[],u=0,a=0;e<r;){var c=t[e++];switch(a){case 0:s[u++]=n[c>>2],i=(3&c)<<4,a=1;break;case 1:s[u++]=n[i|c>>4],i=(15&c)<<2,a=2;break;case 2:s[u++]=n[i|c>>6],s[u++]=n[63&c],a=0}u>8191&&((o||(o=[])).push(String.fromCharCode.apply(String,s)),u=0)}return a&&(s[u++]=n[i],s[u++]=61,1===a&&(s[u++]=61)),o?(u&&o.push(String.fromCharCode.apply(String,s.slice(0,u))),o.join("")):String.fromCharCode.apply(String,s.slice(0,u))};var s="invalid encoding";r.decode=function(t,e,r){for(var n,o=r,u=0,a=0;a<t.length;){var c=t.charCodeAt(a++);if(61===c&&u>1)break;if(void 0===(c=i[c]))throw Error(s);switch(u){case 0:n=c,u=1;break;case 1:e[r++]=n<<2|(48&c)>>4,n=c,u=2;break;case 2:e[r++]=(15&n)<<4|(60&c)>>2,n=c,u=3;break;case 3:e[r++]=(3&n)<<6|c,u=0}}if(1===u)throw Error(s);return r-o},r.test=function(t){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(t)}},9211:function(t){"use strict";function e(){this._listeners={}}t.exports=e,e.prototype.on=function(t,e,r){return(this._listeners[t]||(this._listeners[t]=[])).push({fn:e,ctx:r||this}),this},e.prototype.off=function(t,e){if(void 0===t)this._listeners={};else if(void 0===e)this._listeners[t]=[];else for(var r=this._listeners[t],n=0;n<r.length;)r[n].fn===e?r.splice(n,1):++n;return this},e.prototype.emit=function(t){var e=this._listeners[t];if(e){for(var r=[],n=1;n<arguments.length;)r.push(arguments[n++]);for(n=0;n<e.length;)e[n].fn.apply(e[n++].ctx,r)}return this}},945:function(t){"use strict";function e(t){return"undefined"!=typeof Float32Array?function(){var e=new Float32Array([-0]),r=new Uint8Array(e.buffer),n=128===r[3];function i(t,n,i){e[0]=t,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3]}function o(t,n,i){e[0]=t,n[i]=r[3],n[i+1]=r[2],n[i+2]=r[1],n[i+3]=r[0]}function s(t,n){return r[0]=t[n],r[1]=t[n+1],r[2]=t[n+2],r[3]=t[n+3],e[0]}function u(t,n){return r[3]=t[n],r[2]=t[n+1],r[1]=t[n+2],r[0]=t[n+3],e[0]}t.writeFloatLE=n?i:o,t.writeFloatBE=n?o:i,t.readFloatLE=n?s:u,t.readFloatBE=n?u:s}():function(){function e(t,e,r,n){var i=e<0?1:0;if(i&&(e=-e),0===e)t(1/e>0?0:2147483648,r,n);else if(isNaN(e))t(2143289344,r,n);else if(e>34028234663852886e22)t((i<<31|2139095040)>>>0,r,n);else if(e<11754943508222875e-54)t((i<<31|Math.round(e/1401298464324817e-60))>>>0,r,n);else{var o=Math.floor(Math.log(e)/Math.LN2);t((i<<31|o+127<<23|8388607&Math.round(e*Math.pow(2,-o)*8388608))>>>0,r,n)}}function s(t,e,r){var n=t(e,r),i=2*(n>>31)+1,o=n>>>23&255,s=8388607&n;return 255===o?s?NaN:i*(1/0):0===o?1401298464324817e-60*i*s:i*Math.pow(2,o-150)*(s+8388608)}t.writeFloatLE=e.bind(null,r),t.writeFloatBE=e.bind(null,n),t.readFloatLE=s.bind(null,i),t.readFloatBE=s.bind(null,o)}(),"undefined"!=typeof Float64Array?function(){var e=new Float64Array([-0]),r=new Uint8Array(e.buffer),n=128===r[7];function i(t,n,i){e[0]=t,n[i]=r[0],n[i+1]=r[1],n[i+2]=r[2],n[i+3]=r[3],n[i+4]=r[4],n[i+5]=r[5],n[i+6]=r[6],n[i+7]=r[7]}function o(t,n,i){e[0]=t,n[i]=r[7],n[i+1]=r[6],n[i+2]=r[5],n[i+3]=r[4],n[i+4]=r[3],n[i+5]=r[2],n[i+6]=r[1],n[i+7]=r[0]}function s(t,n){return r[0]=t[n],r[1]=t[n+1],r[2]=t[n+2],r[3]=t[n+3],r[4]=t[n+4],r[5]=t[n+5],r[6]=t[n+6],r[7]=t[n+7],e[0]}function u(t,n){return r[7]=t[n],r[6]=t[n+1],r[5]=t[n+2],r[4]=t[n+3],r[3]=t[n+4],r[2]=t[n+5],r[1]=t[n+6],r[0]=t[n+7],e[0]}t.writeDoubleLE=n?i:o,t.writeDoubleBE=n?o:i,t.readDoubleLE=n?s:u,t.readDoubleBE=n?u:s}():function(){function e(t,e,r,n,i,o){var s=n<0?1:0;if(s&&(n=-n),0===n)t(0,i,o+e),t(1/n>0?0:2147483648,i,o+r);else if(isNaN(n))t(0,i,o+e),t(2146959360,i,o+r);else if(n>17976931348623157e292)t(0,i,o+e),t((s<<31|2146435072)>>>0,i,o+r);else{var u;if(n<22250738585072014e-324)t((u=n/5e-324)>>>0,i,o+e),t((s<<31|u/4294967296)>>>0,i,o+r);else{var a=Math.floor(Math.log(n)/Math.LN2);1024===a&&(a=1023),t(4503599627370496*(u=n*Math.pow(2,-a))>>>0,i,o+e),t((s<<31|a+1023<<20|1048576*u&1048575)>>>0,i,o+r)}}}function s(t,e,r,n,i){var o=t(n,i+e),s=t(n,i+r),u=2*(s>>31)+1,a=s>>>20&2047,c=4294967296*(1048575&s)+o;return 2047===a?c?NaN:u*(1/0):0===a?5e-324*u*c:u*Math.pow(2,a-1075)*(c+4503599627370496)}t.writeDoubleLE=e.bind(null,r,0,4),t.writeDoubleBE=e.bind(null,n,4,0),t.readDoubleLE=s.bind(null,i,0,4),t.readDoubleBE=s.bind(null,o,4,0)}(),t}function r(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function n(t,e,r){e[r]=t>>>24,e[r+1]=t>>>16&255,e[r+2]=t>>>8&255,e[r+3]=255&t}function i(t,e){return(t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24)>>>0}function o(t,e){return(t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3])>>>0}t.exports=e(e)},7199:function(module){"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(t){}return null}module.exports=inquire},6662:function(t){"use strict";t.exports=function(t,e,r){var n=r||8192,i=n>>>1,o=null,s=n;return function(r){if(r<1||r>i)return t(r);s+r>n&&(o=t(n),s=0);var u=e.call(o,s,s+=r);return 7&s&&(s=1+(7|s)),u}}},4997:function(t,e){"use strict";var r=e;r.length=function(t){for(var e=0,r=0,n=0;n<t.length;++n)(r=t.charCodeAt(n))<128?e+=1:r<2048?e+=2:55296==(64512&r)&&56320==(64512&t.charCodeAt(n+1))?(++n,e+=4):e+=3;return e},r.read=function(t,e,r){if(r-e<1)return"";for(var n,i=null,o=[],s=0;e<r;)(n=t[e++])<128?o[s++]=n:n>191&&n<224?o[s++]=(31&n)<<6|63&t[e++]:n>239&&n<365?(n=((7&n)<<18|(63&t[e++])<<12|(63&t[e++])<<6|63&t[e++])-65536,o[s++]=55296+(n>>10),o[s++]=56320+(1023&n)):o[s++]=(15&n)<<12|(63&t[e++])<<6|63&t[e++],s>8191&&((i||(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i?(s&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))},r.write=function(t,e,r){for(var n,i,o=r,s=0;s<t.length;++s)(n=t.charCodeAt(s))<128?e[r++]=n:n<2048?(e[r++]=n>>6|192,e[r++]=63&n|128):55296==(64512&n)&&56320==(64512&(i=t.charCodeAt(s+1)))?(++s,e[r++]=(n=65536+((1023&n)<<10)+(1023&i))>>18|240,e[r++]=n>>12&63|128,e[r++]=n>>6&63|128,e[r++]=63&n|128):(e[r++]=n>>12|224,e[r++]=n>>6&63|128,e[r++]=63&n|128);return r-o}},3720:function(t){t.exports=r;var e=null;try{e=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch(t){}function r(t,e,r){this.low=0|t,this.high=0|e,this.unsigned=!!r}function n(t){return!0===(t&&t.__isLong__)}Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=n;var i={},o={};function s(t,e){var r,n,s;return e?(s=0<=(t>>>=0)&&t<256)&&(n=o[t])?n:(r=a(t,(0|t)<0?-1:0,!0),s&&(o[t]=r),r):(s=-128<=(t|=0)&&t<128)&&(n=i[t])?n:(r=a(t,t<0?-1:0,!1),s&&(i[t]=r),r)}function u(t,e){if(isNaN(t))return e?g:v;if(e){if(t<0)return g;if(t>=_)return I}else{if(t<=-l)return x;if(t+1>=l)return R}return t<0?u(-t,e).neg():a(t%d|0,t/d|0,e)}function a(t,e,n){return new r(t,e,n)}r.fromInt=s,r.fromNumber=u,r.fromBits=a;var c=Math.pow;function f(t,e,r){if(0===t.length)throw Error("empty string");if("NaN"===t||"Infinity"===t||"+Infinity"===t||"-Infinity"===t)return v;if("number"==typeof e?(r=e,e=!1):e=!!e,(r=r||10)<2||36<r)throw RangeError("radix");var n;if((n=t.indexOf("-"))>0)throw Error("interior hyphen");if(0===n)return f(t.substring(1),e,r).neg();for(var i=u(c(r,8)),o=v,s=0;s<t.length;s+=8){var a=Math.min(8,t.length-s),h=parseInt(t.substring(s,s+a),r);if(a<8){var d=u(c(r,a));o=o.mul(d).add(u(h))}else o=(o=o.mul(i)).add(u(h))}return o.unsigned=e,o}function h(t,e){return"number"==typeof t?u(t,e):"string"==typeof t?f(t,e):a(t.low,t.high,"boolean"==typeof e?e:t.unsigned)}r.fromString=f,r.fromValue=h;var d=4294967296,_=d*d,l=_/2,m=s(1<<24),v=s(0);r.ZERO=v;var g=s(0,!0);r.UZERO=g;var p=s(1);r.ONE=p;var b=s(1,!0);r.UONE=b;var E=s(-1);r.NEG_ONE=E;var R=a(-1,2147483647,!1);r.MAX_VALUE=R;var I=a(-1,-1,!0);r.MAX_UNSIGNED_VALUE=I;var x=a(0,-2147483648,!1);r.MIN_VALUE=x;var w=r.prototype;w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*d+(this.low>>>0):this.high*d+(this.low>>>0)},w.toString=function(t){if((t=t||10)<2||36<t)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative()){if(this.eq(x)){var e=u(t),r=this.div(e),n=r.mul(e).sub(this);return r.toString(t)+n.toInt().toString(t)}return"-"+this.neg().toString(t)}for(var i=u(c(t,6),this.unsigned),o=this,s="";;){var a=o.div(i),f=(o.sub(a.mul(i)).toInt()>>>0).toString(t);if((o=a).isZero())return f+s;for(;f.length<6;)f="0"+f;s=""+f+s}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(x)?64:this.neg().getNumBitsAbs();for(var t=0!=this.high?this.high:this.low,e=31;e>0&&0==(t&1<<e);e--);return 0!=this.high?e+33:e+1},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return 1==(1&this.low)},w.isEven=function(){return 0==(1&this.low)},w.equals=function(t){return n(t)||(t=h(t)),(this.unsigned===t.unsigned||this.high>>>31!=1||t.high>>>31!=1)&&(this.high===t.high&&this.low===t.low)},w.eq=w.equals,w.notEquals=function(t){return!this.eq(t)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(t){return this.comp(t)<0},w.lt=w.lessThan,w.lessThanOrEqual=function(t){return this.comp(t)<=0},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(t){return this.comp(t)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(t){return this.comp(t)>=0},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(t){if(n(t)||(t=h(t)),this.eq(t))return 0;var e=this.isNegative(),r=t.isNegative();return e&&!r?-1:!e&&r?1:this.unsigned?t.high>>>0>this.high>>>0||t.high===this.high&&t.low>>>0>this.low>>>0?-1:1:this.sub(t).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(x)?x:this.not().add(p)},w.neg=w.negate,w.add=function(t){n(t)||(t=h(t));var e=0,r=0,i=0,o=0;return i+=(o+=(65535&this.low)+(65535&t.low))>>>16,r+=(i+=(this.low>>>16)+(t.low>>>16))>>>16,e+=(r+=(65535&this.high)+(65535&t.high))>>>16,e+=(this.high>>>16)+(t.high>>>16),a((i&=65535)<<16|(o&=65535),(e&=65535)<<16|(r&=65535),this.unsigned)},w.subtract=function(t){return n(t)||(t=h(t)),this.add(t.neg())},w.sub=w.subtract,w.multiply=function(t){if(this.isZero())return v;if(n(t)||(t=h(t)),e)return a(e.mul(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned);if(t.isZero())return v;if(this.eq(x))return t.isOdd()?x:v;if(t.eq(x))return this.isOdd()?x:v;if(this.isNegative())return t.isNegative()?this.neg().mul(t.neg()):this.neg().mul(t).neg();if(t.isNegative())return this.mul(t.neg()).neg();if(this.lt(m)&&t.lt(m))return u(this.toNumber()*t.toNumber(),this.unsigned);var r=65535&this.high,i=this.low>>>16,o=65535&this.low,s=65535&t.high,c=t.low>>>16,f=65535&t.low,d=0,_=0,l=0,g=0;return l+=(g+=o*f)>>>16,_+=(l+=i*f)>>>16,l&=65535,_+=(l+=o*c)>>>16,d+=(_+=r*f)>>>16,_&=65535,d+=(_+=i*c)>>>16,_&=65535,d+=(_+=o*s)>>>16,d+=(this.high>>>16)*f+r*c+i*s+o*(t.high>>>16),a((l&=65535)<<16|(g&=65535),(d&=65535)<<16|(_&=65535),this.unsigned)},w.mul=w.multiply,w.divide=function(t){if(n(t)||(t=h(t)),t.isZero())throw Error("division by zero");var r,i,o;if(e)return this.unsigned||-2147483648!==this.high||-1!==t.low||-1!==t.high?a((this.unsigned?e.div_u:e.div_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this;if(this.isZero())return this.unsigned?g:v;if(this.unsigned){if(t.unsigned||(t=t.toUnsigned()),t.gt(this))return g;if(t.gt(this.shru(1)))return b;o=g}else{if(this.eq(x))return t.eq(p)||t.eq(E)?x:t.eq(x)?p:(r=this.shr(1).div(t).shl(1)).eq(v)?t.isNegative()?p:E:(i=this.sub(t.mul(r)),o=r.add(i.div(t)));if(t.eq(x))return this.unsigned?g:v;if(this.isNegative())return t.isNegative()?this.neg().div(t.neg()):this.neg().div(t).neg();if(t.isNegative())return this.div(t.neg()).neg();o=v}for(i=this;i.gte(t);){r=Math.max(1,Math.floor(i.toNumber()/t.toNumber()));for(var s=Math.ceil(Math.log(r)/Math.LN2),f=s<=48?1:c(2,s-48),d=u(r),_=d.mul(t);_.isNegative()||_.gt(i);)_=(d=u(r-=f,this.unsigned)).mul(t);d.isZero()&&(d=p),o=o.add(d),i=i.sub(_)}return o},w.div=w.divide,w.modulo=function(t){return n(t)||(t=h(t)),e?a((this.unsigned?e.rem_u:e.rem_s)(this.low,this.high,t.low,t.high),e.get_high(),this.unsigned):this.sub(this.div(t).mul(t))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return a(~this.low,~this.high,this.unsigned)},w.and=function(t){return n(t)||(t=h(t)),a(this.low&t.low,this.high&t.high,this.unsigned)},w.or=function(t){return n(t)||(t=h(t)),a(this.low|t.low,this.high|t.high,this.unsigned)},w.xor=function(t){return n(t)||(t=h(t)),a(this.low^t.low,this.high^t.high,this.unsigned)},w.shiftLeft=function(t){return n(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?a(this.low<<t,this.high<<t|this.low>>>32-t,this.unsigned):a(0,this.low<<t-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(t){return n(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?a(this.low>>>t|this.high<<32-t,this.high>>t,this.unsigned):a(this.high>>t-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(t){if(n(t)&&(t=t.toInt()),0===(t&=63))return this;var e=this.high;return t<32?a(this.low>>>t|e<<32-t,e>>>t,this.unsigned):a(32===t?e:e>>>t-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.toSigned=function(){return this.unsigned?a(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:a(this.low,this.high,!0)},w.toBytes=function(t){return t?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var t=this.high,e=this.low;return[255&e,e>>>8&255,e>>>16&255,e>>>24,255&t,t>>>8&255,t>>>16&255,t>>>24]},w.toBytesBE=function(){var t=this.high,e=this.low;return[t>>>24,t>>>16&255,t>>>8&255,255&t,e>>>24,e>>>16&255,e>>>8&255,255&e]},r.fromBytes=function(t,e,n){return n?r.fromBytesLE(t,e):r.fromBytesBE(t,e)},r.fromBytesLE=function(t,e){return new r(t[0]|t[1]<<8|t[2]<<16|t[3]<<24,t[4]|t[5]<<8|t[6]<<16|t[7]<<24,e)},r.fromBytesBE=function(t,e){return new r(t[4]<<24|t[5]<<16|t[6]<<8|t[7],t[0]<<24|t[1]<<16|t[2]<<8|t[3],e)}},2100:function(t,e,r){"use strict";t.exports=r(9482)},9482:function(t,e,r){"use strict";var n=e;function i(){n.util._configure(),n.Writer._configure(n.BufferWriter),n.Reader._configure(n.BufferReader)}n.build="minimal",n.Writer=r(1173),n.BufferWriter=r(3155),n.Reader=r(1408),n.BufferReader=r(593),n.util=r(9693),n.rpc=r(5994),n.roots=r(5054),n.configure=i,i()},1408:function(t,e,r){"use strict";t.exports=a;var n,i=r(9693),o=i.LongBits,s=i.utf8;function u(t,e){return RangeError("index out of range: "+t.pos+" + "+(e||1)+" > "+t.len)}function a(t){this.buf=t,this.pos=0,this.len=t.length}var c,f="undefined"!=typeof Uint8Array?function(t){if(t instanceof Uint8Array||Array.isArray(t))return new a(t);throw Error("illegal buffer")}:function(t){if(Array.isArray(t))return new a(t);throw Error("illegal buffer")},h=function(){return i.Buffer?function(t){return(a.create=function(t){return i.Buffer.isBuffer(t)?new n(t):f(t)})(t)}:f};function d(){var t=new o(0,0),e=0;if(!(this.len-this.pos>4)){for(;e<3;++e){if(this.pos>=this.len)throw u(this);if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(127&this.buf[this.pos++])<<7*e)>>>0,t}for(;e<4;++e)if(t.lo=(t.lo|(127&this.buf[this.pos])<<7*e)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(127&this.buf[this.pos])<<28)>>>0,t.hi=(t.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return t;if(e=0,this.len-this.pos>4){for(;e<5;++e)if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}else for(;e<5;++e){if(this.pos>=this.len)throw u(this);if(t.hi=(t.hi|(127&this.buf[this.pos])<<7*e+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}function _(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}function l(){if(this.pos+8>this.len)throw u(this,8);return new o(_(this.buf,this.pos+=4),_(this.buf,this.pos+=4))}a.create=h(),a.prototype._slice=i.Array.prototype.subarray||i.Array.prototype.slice,a.prototype.uint32=(c=4294967295,function(){if(c=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)return c;if(c=(c|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128)return c;if((this.pos+=5)>this.len)throw this.pos=this.len,u(this,10);return c}),a.prototype.int32=function(){return 0|this.uint32()},a.prototype.sint32=function(){var t=this.uint32();return t>>>1^-(1&t)|0},a.prototype.bool=function(){return 0!==this.uint32()},a.prototype.fixed32=function(){if(this.pos+4>this.len)throw u(this,4);return _(this.buf,this.pos+=4)},a.prototype.sfixed32=function(){if(this.pos+4>this.len)throw u(this,4);return 0|_(this.buf,this.pos+=4)},a.prototype.float=function(){if(this.pos+4>this.len)throw u(this,4);var t=i.float.readFloatLE(this.buf,this.pos);return this.pos+=4,t},a.prototype.double=function(){if(this.pos+8>this.len)throw u(this,4);var t=i.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,t},a.prototype.bytes=function(){var t=this.uint32(),e=this.pos,r=this.pos+t;if(r>this.len)throw u(this,t);return this.pos+=t,Array.isArray(this.buf)?this.buf.slice(e,r):e===r?new this.buf.constructor(0):this._slice.call(this.buf,e,r)},a.prototype.string=function(){var t=this.bytes();return s.read(t,0,t.length)},a.prototype.skip=function(t){if("number"==typeof t){if(this.pos+t>this.len)throw u(this,t);this.pos+=t}else do{if(this.pos>=this.len)throw u(this)}while(128&this.buf[this.pos++]);return this},a.prototype.skipType=function(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(t=7&this.uint32());)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+t+" at offset "+this.pos)}return this},a._configure=function(t){n=t,a.create=h(),n._configure();var e=i.Long?"toLong":"toNumber";i.merge(a.prototype,{int64:function(){return d.call(this)[e](!1)},uint64:function(){return d.call(this)[e](!0)},sint64:function(){return d.call(this).zzDecode()[e](!1)},fixed64:function(){return l.call(this)[e](!0)},sfixed64:function(){return l.call(this)[e](!1)}})}},593:function(t,e,r){"use strict";t.exports=o;var n=r(1408);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(9693);function o(t){n.call(this,t)}o._configure=function(){i.Buffer&&(o.prototype._slice=i.Buffer.prototype.slice)},o.prototype.string=function(){var t=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+t,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+t,this.len))},o._configure()},5054:function(t){"use strict";t.exports={}},5994:function(t,e,r){"use strict";e.Service=r(7948)},7948:function(t,e,r){"use strict";t.exports=i;var n=r(9693);function i(t,e,r){if("function"!=typeof t)throw TypeError("rpcImpl must be a function");n.EventEmitter.call(this),this.rpcImpl=t,this.requestDelimited=Boolean(e),this.responseDelimited=Boolean(r)}(i.prototype=Object.create(n.EventEmitter.prototype)).constructor=i,i.prototype.rpcCall=function t(e,r,i,o,s){if(!o)throw TypeError("request must be specified");var u=this;if(!s)return n.asPromise(t,u,e,r,i,o);if(u.rpcImpl)try{return u.rpcImpl(e,r[u.requestDelimited?"encodeDelimited":"encode"](o).finish(),(function(t,r){if(t)return u.emit("error",t,e),s(t);if(null!==r){if(!(r instanceof i))try{r=i[u.responseDelimited?"decodeDelimited":"decode"](r)}catch(t){return u.emit("error",t,e),s(t)}return u.emit("data",r,e),s(null,r)}u.end(!0)}))}catch(t){return u.emit("error",t,e),void setTimeout((function(){s(t)}),0)}else setTimeout((function(){s(Error("already ended"))}),0)},i.prototype.end=function(t){return this.rpcImpl&&(t||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},2630:function(t,e,r){"use strict";t.exports=i;var n=r(9693);function i(t,e){this.lo=t>>>0,this.hi=e>>>0}var o=i.zero=new i(0,0);o.toNumber=function(){return 0},o.zzEncode=o.zzDecode=function(){return this},o.length=function(){return 1};var s=i.zeroHash="\0\0\0\0\0\0\0\0";i.fromNumber=function(t){if(0===t)return o;var e=t<0;e&&(t=-t);var r=t>>>0,n=(t-r)/4294967296>>>0;return e&&(n=~n>>>0,r=~r>>>0,++r>4294967295&&(r=0,++n>4294967295&&(n=0))),new i(r,n)},i.from=function(t){if("number"==typeof t)return i.fromNumber(t);if(n.isString(t)){if(!n.Long)return i.fromNumber(parseInt(t,10));t=n.Long.fromString(t)}return t.low||t.high?new i(t.low>>>0,t.high>>>0):o},i.prototype.toNumber=function(t){if(!t&&this.hi>>>31){var e=1+~this.lo>>>0,r=~this.hi>>>0;return e||(r=r+1>>>0),-(e+4294967296*r)}return this.lo+4294967296*this.hi},i.prototype.toLong=function(t){return n.Long?new n.Long(0|this.lo,0|this.hi,Boolean(t)):{low:0|this.lo,high:0|this.hi,unsigned:Boolean(t)}};var u=String.prototype.charCodeAt;i.fromHash=function(t){return t===s?o:new i((u.call(t,0)|u.call(t,1)<<8|u.call(t,2)<<16|u.call(t,3)<<24)>>>0,(u.call(t,4)|u.call(t,5)<<8|u.call(t,6)<<16|u.call(t,7)<<24)>>>0)},i.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},i.prototype.zzEncode=function(){var t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this},i.prototype.zzDecode=function(){var t=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this},i.prototype.length=function(){var t=this.lo,e=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===e?t<16384?t<128?1:2:t<2097152?3:4:e<16384?e<128?5:6:e<2097152?7:8:r<128?9:10}},9693:function(t,e,r){"use strict";var n=e;function i(t,e,r){for(var n=Object.keys(e),i=0;i<n.length;++i)void 0!==t[n[i]]&&r||(t[n[i]]=e[n[i]]);return t}function o(t){function e(t,r){if(!(this instanceof e))return new e(t,r);Object.defineProperty(this,"message",{get:function(){return t}}),Error.captureStackTrace?Error.captureStackTrace(this,e):Object.defineProperty(this,"stack",{value:(new Error).stack||""}),r&&i(this,r)}return(e.prototype=Object.create(Error.prototype)).constructor=e,Object.defineProperty(e.prototype,"name",{get:function(){return t}}),e.prototype.toString=function(){return this.name+": "+this.message},e}n.asPromise=r(4537),n.base64=r(7419),n.EventEmitter=r(9211),n.float=r(945),n.inquire=r(7199),n.utf8=r(4997),n.pool=r(6662),n.LongBits=r(2630),n.isNode=Boolean(void 0!==r.g&&r.g&&r.g.process&&r.g.process.versions&&r.g.process.versions.node),n.global=n.isNode&&r.g||"undefined"!=typeof window&&window||"undefined"!=typeof self&&self||this,n.emptyArray=Object.freeze?Object.freeze([]):[],n.emptyObject=Object.freeze?Object.freeze({}):{},n.isInteger=Number.isInteger||function(t){return"number"==typeof t&&isFinite(t)&&Math.floor(t)===t},n.isString=function(t){return"string"==typeof t||t instanceof String},n.isObject=function(t){return t&&"object"==typeof t},n.isset=n.isSet=function(t,e){var r=t[e];return!(null==r||!t.hasOwnProperty(e))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},n.Buffer=function(){try{var t=n.inquire("buffer").Buffer;return t.prototype.utf8Write?t:null}catch(t){return null}}(),n._Buffer_from=null,n._Buffer_allocUnsafe=null,n.newBuffer=function(t){return"number"==typeof t?n.Buffer?n._Buffer_allocUnsafe(t):new n.Array(t):n.Buffer?n._Buffer_from(t):"undefined"==typeof Uint8Array?t:new Uint8Array(t)},n.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,n.Long=n.global.dcodeIO&&n.global.dcodeIO.Long||n.global.Long||n.inquire("long"),n.key2Re=/^true|false|0|1$/,n.key32Re=/^-?(?:0|[1-9][0-9]*)$/,n.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,n.longToHash=function(t){return t?n.LongBits.from(t).toHash():n.LongBits.zeroHash},n.longFromHash=function(t,e){var r=n.LongBits.fromHash(t);return n.Long?n.Long.fromBits(r.lo,r.hi,e):r.toNumber(Boolean(e))},n.merge=i,n.lcFirst=function(t){return t.charAt(0).toLowerCase()+t.substring(1)},n.newError=o,n.ProtocolError=o("ProtocolError"),n.oneOfGetter=function(t){for(var e={},r=0;r<t.length;++r)e[t[r]]=1;return function(){for(var t=Object.keys(this),r=t.length-1;r>-1;--r)if(1===e[t[r]]&&null!=this[t[r]])return t[r]}},n.oneOfSetter=function(t){return function(e){for(var r=0;r<t.length;++r)t[r]!==e&&delete this[t[r]]}},n.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},n._configure=function(){var t=n.Buffer;t?(n._Buffer_from=t.from!==Uint8Array.from&&t.from||function(e,r){return new t(e,r)},n._Buffer_allocUnsafe=t.allocUnsafe||function(e){return new t(e)}):n._Buffer_from=n._Buffer_allocUnsafe=null}},1173:function(t,e,r){"use strict";t.exports=h;var n,i=r(9693),o=i.LongBits,s=i.base64,u=i.utf8;function a(t,e,r){this.fn=t,this.len=e,this.next=void 0,this.val=r}function c(){}function f(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}function h(){this.len=0,this.head=new a(c,0,0),this.tail=this.head,this.states=null}var d=function(){return i.Buffer?function(){return(h.create=function(){return new n})()}:function(){return new h}};function _(t,e,r){e[r]=255&t}function l(t,e){this.len=t,this.next=void 0,this.val=e}function m(t,e,r){for(;t.hi;)e[r++]=127&t.lo|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=127&t.lo|128,t.lo=t.lo>>>7;e[r++]=t.lo}function v(t,e,r){e[r]=255&t,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}h.create=d(),h.alloc=function(t){return new i.Array(t)},i.Array!==Array&&(h.alloc=i.pool(h.alloc,i.Array.prototype.subarray)),h.prototype._push=function(t,e,r){return this.tail=this.tail.next=new a(t,e,r),this.len+=e,this},(l.prototype=Object.create(a.prototype)).fn=function(t,e,r){for(;t>127;)e[r++]=127&t|128,t>>>=7;e[r]=t},h.prototype.uint32=function(t){return this.len+=(this.tail=this.tail.next=new l((t>>>=0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this},h.prototype.int32=function(t){return t<0?this._push(m,10,o.fromNumber(t)):this.uint32(t)},h.prototype.sint32=function(t){return this.uint32((t<<1^t>>31)>>>0)},h.prototype.int64=h.prototype.uint64=function(t){var e=o.from(t);return this._push(m,e.length(),e)},h.prototype.sint64=function(t){var e=o.from(t).zzEncode();return this._push(m,e.length(),e)},h.prototype.bool=function(t){return this._push(_,1,t?1:0)},h.prototype.sfixed32=h.prototype.fixed32=function(t){return this._push(v,4,t>>>0)},h.prototype.sfixed64=h.prototype.fixed64=function(t){var e=o.from(t);return this._push(v,4,e.lo)._push(v,4,e.hi)},h.prototype.float=function(t){return this._push(i.float.writeFloatLE,4,t)},h.prototype.double=function(t){return this._push(i.float.writeDoubleLE,8,t)};var g=i.Array.prototype.set?function(t,e,r){e.set(t,r)}:function(t,e,r){for(var n=0;n<t.length;++n)e[r+n]=t[n]};h.prototype.bytes=function(t){var e=t.length>>>0;if(!e)return this._push(_,1,0);if(i.isString(t)){var r=h.alloc(e=s.length(t));s.decode(t,r,0),t=r}return this.uint32(e)._push(g,e,t)},h.prototype.string=function(t){var e=u.length(t);return e?this.uint32(e)._push(u.write,e,t):this._push(_,1,0)},h.prototype.fork=function(){return this.states=new f(this),this.head=this.tail=new a(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new a(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var t=this.head,e=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=t.next,this.tail=e,this.len+=r),this},h.prototype.finish=function(){for(var t=this.head.next,e=this.constructor.alloc(this.len),r=0;t;)t.fn(t.val,e,r),r+=t.len,t=t.next;return e},h._configure=function(t){n=t,h.create=d(),n._configure()}},3155:function(t,e,r){"use strict";t.exports=o;var n=r(1173);(o.prototype=Object.create(n.prototype)).constructor=o;var i=r(9693);function o(){n.call(this)}function s(t,e,r){t.length<40?i.utf8.write(t,e,r):e.utf8Write?e.utf8Write(t,r):e.write(t,r)}o._configure=function(){o.alloc=i._Buffer_allocUnsafe,o.writeBytesBuffer=i.Buffer&&i.Buffer.prototype instanceof Uint8Array&&"set"===i.Buffer.prototype.set.name?function(t,e,r){e.set(t,r)}:function(t,e,r){if(t.copy)t.copy(e,r,0,t.length);else for(var n=0;n<t.length;)e[r++]=t[n++]}},o.prototype.bytes=function(t){i.isString(t)&&(t=i._Buffer_from(t,"base64"));var e=t.length>>>0;return this.uint32(e),e&&this._push(o.writeBytesBuffer,e,t),this},o.prototype.string=function(t){var e=i.Buffer.byteLength(t);return this.uint32(e),e&&this._push(s,e,t),this},o._configure()},3873:function(t,e,r){"use strict";var n,i;r(4119);!function(t){t[t.debug=0]="debug",t[t.info=1]="info",t[t.warn=2]="warn",t[t.error=3]="error",t[t.report=99]="report",t[t.disable=100]="disable"}(n||(n={})),function(t){t[t.CN=2]="CN",t[t.NA=3]="NA",t[t.EU=4]="EU",t[t.AS=5]="AS",t[t.IN=6]="IN",t[t.NCN=7]="NCN"}(i||(i={}));var o,s;!function(t){t[t.disable=0]="disable",t[t.websocket=1]="websocket",t[t.https=2]="https"}(o||(o={})),function(t){t[t.SDKProject_Other=0]="SDKProject_Other",t[t.SDKProject_ZegoExpressVideo=1]="SDKProject_ZegoExpressVideo",t[t.SDKProject_ZegoExpressAudio=2]="SDKProject_ZegoExpressAudio",t[t.SDKProject_ZegoLiveRoom=3]="SDKProject_ZegoLiveRoom",t[t.SDKProject_ZegoAudioRoom=4]="SDKProject_ZegoAudioRoom",t[t.SDKProject_ZegoAVKit=5]="SDKProject_ZegoAVKit",t[t.SDKProject_ZegoWebRTC=6]="SDKProject_ZegoWebRTC",t[t.SDKProject_ZegoMiniProgram=7]="SDKProject_ZegoMiniProgram"}(s||(s={}));var u;!function(t){t[t.disconnected=0]="disconnected",t[t.connecting=1]="connecting",t[t.connected=2]="connected"}(u||(u={}));var a,c,f,h;!function(t){t[t.tryProbe=0]="tryProbe",t[t.probed=2]="probed"}(a||(a={})),function(t){t[t.CDN=0]="CDN",t[t.RTC=1]="RTC",t[t.L3=2]="L3",t[t.DG=3]="DG"}(c||(c={})),function(t){t[t.UDP=0]="UDP",t[t.RTMP=1]="RTMP",t[t.FLV=2]="FLV",t[t.HLS=3]="HLS",t[t.WEBRTC=4]="WEBRTC"}(f||(f={})),function(t){t[t.replaceNew=0]="replaceNew",t[t.changeResolution=1]="changeResolution"}(h||(h={}));var d,_,l;!function(t){t[t.logout=0]="logout",t[t.trylogin=1]="trylogin",t[t.login=2]="login"}(d||(d={})),function(t){t[t.logout=0]="logout",t[t.trylogin=1]="trylogin",t[t.login=2]="login",t[t.reconnect=3]="reconnect"}(_||(_={})),function(t){t[t.offline=0]="offline",t[t.online=1]="online"}(l||(l={}));var m;!function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CDN=1]="CDN",t[t.RTC=2]="RTC",t[t.L3=3]="L3"}(m||(m={}));var v,g;!function(t){t[t.publish_quality=0]="publish_quality",t[t.play_quality=1]="play_quality",t[t.charge=2]="charge"}(v||(v={})),function(t){t[t.low=1]="low",t[t.stantard=2]="stantard",t[t.hight=3]="hight",t[t.custome=4]="custome"}(g||(g={}));var p,b,E,R,I,x;!function(t){t[t.captureFpsToLow=1001]="captureFpsToLow",t[t.captureVolumeToLow=1002]="captureVolumeToLow",t[t.sendVideoBitrateToLow=1003]="sendVideoBitrateToLow",t[t.sendFpsToLow=1004]="sendFpsToLow",t[t.sendAudioBitrateToLow=1005]="sendAudioBitrateToLow",t[t.receiveVolumeToLow=1006]="receiveVolumeToLow",t[t.receiveAudioDecodedFail=1007]="receiveAudioDecodedFail",t[t.receiveVideoDecodedFail=1008]="receiveVideoDecodedFail",t[t.receiveVideoFpsDecodedToLow=1009]="receiveVideoFpsDecodedToLow",t[t.renderVideoFpsToLow=1010]="renderVideoFpsToLow",t[t.captureFpsNormal=2001]="captureFpsNormal",t[t.captureVolumeNormal=2002]="captureVolumeNormal",t[t.sendVideoBitrateNormal=2003]="sendVideoBitrateNormal",t[t.sendFpsNormal=2004]="sendFpsNormal",t[t.sendAudioBitrateNormal=2005]="sendAudioBitrateNormal",t[t.receiveVolumeNormal=2006]="receiveVolumeNormal",t[t.receiveAudioDecodedNormal=2007]="receiveAudioDecodedNormal",t[t.receiveVideoDecodedNormal=2008]="receiveVideoDecodedNormal",t[t.receiveVideoFpsDecodedNormal=2009]="receiveVideoFpsDecodedNormal",t[t.renderVideoFpsNormal=2010]="renderVideoFpsNormal"}(p||(p={})),function(t){t[t.cdn=0]="cdn",t[t.ultra=1]="ultra"}(b||(b={})),function(t){t[t.stop=0]="stop",t[t.start=1]="start"}(E||(E={})),function(t){t[t.cdn=0]="cdn",t[t.ultra=1]="ultra",t[t.customUrl=2]="customUrl"}(R||(R={})),function(t){t[t.CDN=0]="CDN",t[t.BGP=1]="BGP"}(I||(I={})),function(t){t[t.ClientType_None=0]="ClientType_None",t[t.ClientType_H5=1]="ClientType_H5",t[t.ClientType_SmallPragram=2]="ClientType_SmallPragram",t[t.ClientType_Webrtc=3]="ClientType_Webrtc"}(x||(x={}));var w,M,S,T,y,O,C,k,D,N,A,z,U,L,q,P=function(){function t(t,e){void 0===t&&(t=null),void 0===e&&(e=null),this._id=null,this.next=null,this.prev=null,this._id=t,this._data=e}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id?this._id:null},set:function(t){this._id=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"data",{get:function(){return this._data},set:function(t){this._data=t},enumerable:!1,configurable:!0}),t.prototype.hasNext=function(){return this.next&&this.next.id},t.prototype.hasPrev=function(){return this.prev&&this.prev.id},t}();!function(){function t(){this.start=new P,this.end=new P,this._idCounter=0,this._numNodes=0,this.start.next=this.end,this.start.prev=null,this.end.prev=this.start,this.end.next=null}t.prototype.insertBefore=function(t,e){var r=new P(this._idCounter,e);return r.next=t,r.prev=t.prev,t.prev&&(t.prev.next=r),t.prev=r,++this._idCounter,++this._numNodes,r},t.prototype.addLast=function(t){return this.insertBefore(this.end,t)},t.prototype.add=function(t){return this.addLast(t)},t.prototype.getFirst=function(){return 0===this._numNodes?null:this.start.next},t.prototype.getLast=function(){return 0===this._numNodes?null:this.end.prev},t.prototype.size=function(){return this._numNodes},t.prototype.getFromFirst=function(t){var e=0,r=this.start.next;if(t>=0)for(;e<t&&null!==r;)r=r.next,++e;else r=null;if(null===r)throw"Index out of bounds.";return r},t.prototype.get=function(t){return 0===t?this.getFirst():t===this._numNodes-1?this.getLast():this.getFromFirst(t)},t.prototype.remove=function(t){return t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),--this._numNodes,t},t.prototype.removeFirst=function(){var t=null;return this._numNodes>0&&this.start.next&&(t=this.remove(this.start.next)),t},t.prototype.removeLast=function(){var t=null;return this._numNodes>0&&this.end.prev&&(t=this.remove(this.end.prev)),t},t.prototype.removeAll=function(){this.start.next=this.end,this.end.prev=this.start,this._numNodes=0,this._idCounter=0},t.prototype.each=function(t){for(var e=this.start;e.hasNext();)t(e=e.next)},t.prototype.find=function(t){for(var e=this.start,r=!1,n=null;e.hasNext()&&!r;)t(e=e.next)&&(n=e,r=!0);return n},t.prototype.map=function(t){for(var e=this.start,r=[];e.hasNext();)t(e=e.next)&&r.push(e);return r},t.prototype.push=function(t){return this.addLast(t)},t.prototype.unshift=function(t){this.insertBefore(this._numNodes>0?this.start.next:this.end,t)},t.prototype.pop=function(){return this.removeLast()},t.prototype.shift=function(){return this.removeFirst()}}();!function(t){t[t.Unknown=-1]="Unknown",t[t.Excellent=0]="Excellent",t[t.Good=1]="Good",t[t.Middle=2]="Middle",t[t.Poor=3]="Poor",t[t.Die=4]="Die"}(w||(w={})),function(t){t[t.MinQuality=0]="MinQuality",t[t.DieQuality=0]="DieQuality",t[t.PoorMinQuality=1]="PoorMinQuality",t[t.MiddleMinQuality=30]="MiddleMinQuality",t[t.GoodMinQuality=60]="GoodMinQuality",t[t.ExcellentMinQuality=85]="ExcellentMinQuality",t[t.MaxQuality=100]="MaxQuality"}(M||(M={})),function(t){t[t.ZegoDefined=0]="ZegoDefined",t[t.UserUnregister=1]="UserUnregister"}(S||(S={})),function(t){t[t.CDN=0]="CDN",t[t.L3=1]="L3"}(T||(T={})),function(t){t[t.RTC=0]="RTC",t[t.CDN=1]="CDN",t[t.L3=2]="L3",t[t.DG=3]="DG"}(y||(y={})),function(t){t[t.PortraitSegmentation=0]="PortraitSegmentation"}(O||(O={})),function(t){t[t.Default=3]="Default",t[t.StandardVideoCall=4]="StandardVideoCall",t[t.HighVideoCall=5]="HighVideoCall",t[t.StandardChatroom=6]="StandardChatroom",t[t.HighQualityChatroom=7]="HighQualityChatroom",t[t.Broadcast=8]="Broadcast",t[t.UNKNOWN=100]="UNKNOWN"}(C||(C={})),function(t){t[t.I=0]="I",t[t.H=10]="H",t[t.M=100]="M",t[t.L=1e3]="L"}(k||(k={})),function(t){t[t.BASE_LINE=1]="BASE_LINE",t[t.MAIN=2]="MAIN",t[t.HIGH=3]="HIGH"}(D||(D={})),function(t){t.ONLY_BASELINE="only_baseline",t.HARD_SOFT_ENCODEC_FIRST="hard_or_soft_encodec_first",t.HIGH_PROFILE_FIRST="high_profile_first"}(N||(N={})),function(t){t[t.useAnalyzer=0]="useAnalyzer",t[t.useWorklet=1]="useWorklet"}(A||(A={})),function(t){t[t.None=0]="None",t[t.Vocalist=1]="Vocalist",t[t.BackingSinging=2]="BackingSinging"}(z||(z={})),function(t){t[t.METHOD_UNSET=0]="METHOD_UNSET",t[t.METHOD_GET=1]="METHOD_GET",t[t.METHOD_POST=2]="METHOD_POST",t[t.METHOD_PUT=3]="METHOD_PUT",t[t.METHOD_PATCH=4]="METHOD_PATCH",t[t.METHOD_DELETE=5]="METHOD_DELETE",t[t.METHOD_HEAD=6]="METHOD_HEAD",t[t.METHOD_OPTIONS=7]="METHOD_OPTIONS"}(U||(U={})),function(t){t[t.SERVICE_UNSET=0]="SERVICE_UNSET",t[t.SERVICE_MEDIAGW=1]="SERVICE_MEDIAGW",t[t.SERVICE_LIVEROOM=2]="SERVICE_LIVEROOM",t[t.SERVICE_MIX=3]="SERVICE_MIX",t[t.SERVICE_ZEUS=4]="SERVICE_ZEUS",t[t.SERVICE_ZPUSH=5]="SERVICE_ZPUSH",t[t.SERVICE_L3=6]="SERVICE_L3",t[t.SERVICE_TALKLINE=7]="SERVICE_TALKLINE",t[t.SERVICE_EDUSUITE=8]="SERVICE_EDUSUITE",t[t.SERVICE_ZIM=9]="SERVICE_ZIM",t[t.SERVICE_ClOUD_SETTING=10]="SERVICE_ClOUD_SETTING",t[t.SERVICE_ZEUSHB=11]="SERVICE_ZEUSHB",t[t.SERVICE_USER_LOGIC=12]="SERVICE_USER_LOGIC",t[t.SERVICE_UNIFYDISPATCH=13]="SERVICE_UNIFYDISPATCH",t[t.SERVICE_QUALITY=14]="SERVICE_QUALITY",t[t.SERVICE_SECURITY=15]="SERVICE_SECURITY",t[t.SERVICE_KTVCPR=16]="SERVICE_KTVCPR",t[t.SERVICE_SWITCH4LIVEROOM=17]="SERVICE_SWITCH4LIVEROOM",t[t.SERVICE_WEBRTC_SIGNAL=18]="SERVICE_WEBRTC_SIGNAL",t[t.SERVICE_L3_WEBRTC_SIGNAL=19]="SERVICE_L3_WEBRTC_SIGNAL",t[t.SERVICE_VIDEOCPR=20]="SERVICE_VIDEOCPR",t[t.SERVICE_CDN=21]="SERVICE_CDN",t[t.SERVICE_CLOUDRECORD=22]="SERVICE_CLOUDRECORD",t[t.SERVICE_INNER_ECHO=23]="SERVICE_INNER_ECHO",t[t.SERVICE_OUTER_ECHO=24]="SERVICE_OUTER_ECHO",t[t.SERVICE_LOCALHOST_ECHO=25]="SERVICE_LOCALHOST_ECHO",t[t.SERVICE_ECHO=26]="SERVICE_ECHO",t[t.SERVICE_DOCSERVICE=27]="SERVICE_DOCSERVICE",t[t.SERVICE_AUTHSVR=28]="SERVICE_AUTHSVR"}(L||(L={})),function(t){t[t.Default=0]="Default",t[t.Extranet=1]="Extranet",t[t.Intranet=2]="Intranet"}(q||(q={}))},1945:function(t,e,r){"use strict";r.d(e,{B_k:function(){return _},Bo8:function(){return f},Ccg:function(){return ct},Cqc:function(){return ut},DFx:function(){return V},EQN:function(){return X},E_F:function(){return $},FJ5:function(){return g},FfT:function(){return M},Ig8:function(){return et},IlQ:function(){return k},JP1:function(){return xt},JkR:function(){return tt},KC1:function(){return a},LXI:function(){return d},LbG:function(){return z},LbU:function(){return R},NAc:function(){return C},Ocl:function(){return nt},Ozi:function(){return p},Pv8:function(){return bt},QQV:function(){return U},Qij:function(){return Et},Qmj:function(){return St},QtR:function(){return h},Qvv:function(){return b},RBy:function(){return mt},Rp2:function(){return ht},S42:function(){return at},SCO:function(){return l},SxX:function(){return D},T5M:function(){return st},THg:function(){return Mt},Tmx:function(){return o},UB3:function(){return ft},UIH:function(){return s},UTJ:function(){return pt},VNz:function(){return F},Val:function(){return N},WMv:function(){return S},XDk:function(){return vt},Ylh:function(){return ot},ZGq:function(){return Y},_2j:function(){return m},__d:function(){return Ot},_jD:function(){return dt},abZ:function(){return E},asn:function(){return P},brp:function(){return K},cU0:function(){return W},dOV:function(){return c},drH:function(){return Rt},dwx:function(){return _t},f$V:function(){return x},fj3:function(){return w},g6T:function(){return J},gQb:function(){return L},gqw:function(){return j},hxn:function(){return G},hyo:function(){return Z},iGb:function(){return H},iql:function(){return rt},k4s:function(){return yt},kbn:function(){return B},nAK:function(){return v},p$g:function(){return gt},q$n:function(){return T},qC0:function(){return I},rBC:function(){return It},s4z:function(){return Tt},sHT:function(){return A},sRQ:function(){return u},tuu:function(){return Q},v0m:function(){return lt},vJ6:function(){return q},xg2:function(){return it},yhe:function(){return O},zXm:function(){return wt},zy3:function(){return y}});var n=r(6306),i="the user cancels the stream request.",o={code:1000002,message:"not login room"},s={code:1000014,message:"stream ID is too long"},u={code:1000015,message:"streamID is empty"},a={code:1000016,message:"stream ID contains illegal characters"},c={code:1000017,message:n.Fq},f={code:1000018,message:n.Qx},h={code:1100001,message:n.v4},d={code:1100002,message:"network timeout."},_={code:1100999,message:"unknown server error"},l={code:1101005,message:"signal hb fail"},m={code:1002014,msg:n.E3},v={code:1102017,message:"dispatch error"},g={code:1102018,message:"token expired"},p={code:1102021,message:"biz channel error."},b={code:1102022,message:"dispatch request timeout"},E={code:1102024,message:"invalid channel"},R={code:1003025,message:"stream is forbided by media server"},I={code:1003050,message:"extra info of publishing stream is null"},x={code:1103001,message:n.v4},w={code:1103002,message:"browser do not support"},M={code:1103010,message:"screen fail"},S={code:1103011,message:"enumerate devices fail"},T={code:1103021,message:"session request fail"},y={code:1103022,message:"create offer error"},O={code:1103023,message:"setLocalDescription error"},C={code:1103024,message:"mediaDesc error"},k={code:1103025,message:"other side offer error"},D={code:1103026,message:"candidate error"},N={code:1103027,message:"server session closed"},A={code:1103028,message:"ice connection error"},z={code:1103030,message:"negotiation timeout"},U={code:1103042,message:"screen canceled"},L={code:1103043,message:"screen not support"},q={code:1103044,message:n.b0},P={code:1103099,message:"stream is not capturing"},V={code:1103049,message:"repeated pull same stream"},X={code:1103050,message:"websocket disconnected"},j={code:1103051,message:"publisher retry timeout"},$={code:1103053,message:"https is required"},H={code:1103055,message:n.eW},B={code:1103056,message:"publish is publishing"},G={code:1103058,message:"client ip changed"},F={code:1103059,message:"ttl over time"},W={code:1103060,message:"session request timeout"},Q={code:1103061,message:"get media fail"},K={code:1103062,message:"update stream info fail"},Z={code:1103063,message:"publish target no response"},J={code:1103064,message:"get device not allowed"},Y={code:1103065,message:"device is not readable"},tt={code:1103066,message:"device does not meet constraints"},et={code:1103067,message:"update sdp time out"},rt={code:1103068,message:"update sdp fail"},nt={code:1103073,message:"video effect is starting, please operate after video effect is started"},it={code:1103078,message:"publish stream poor and net probe poor"},ot={code:1103089,message:i},st={code:1104001,message:"input parm error"},ut={code:1104021,message:"session request fail"},at={code:1104022,message:"create offer error"},ct={code:1104023,message:"setLocalDescription error"},ft={code:1104024,message:"mediaDesc error"},ht={code:1104025,message:"other side offer error"},dt={code:1104026,message:"candidate error"},_t={code:1104027,message:"server session closed"},lt={code:1104028,message:"ice connection error"},mt={code:1104029,message:"websocket disconnected"},vt={code:1104030,message:"negotiation timeout"},gt={code:1104031,message:"player retry timeout"},pt={code:1104032,message:"player is playing"},bt={code:1104033,message:"client ip changed"},Et={code:1104034,message:"ttl is over time"},Rt={code:1104035,message:"reset session push"},It={code:1104036,message:"session request timeout"},xt={code:1104037,message:"probe time out"},wt={code:1104038,message:"resource mode is not supported"},Mt={code:1104039,message:"play stream not found"},St={code:1104041,message:"stream quality poor and net probe poor"},Tt={code:1104042,message:i},yt={code:1104043,message:"mini sdp error"},Ot={code:1103100,message:"background process is start, but not subscribe yet"}},5245:function(t,e,r){"use strict";r.d(e,{Gp:function(){return u},MK:function(){return s}});var n=r(1945),i=r(4747),o="/sdk/init",s={event:o},u={event:"/sdk/create_stream",error:{t:n.fj3,i:n.f$V,u:n.QQV,_:n.FfT,l:n.gQb,m:n.E_F,v:n.tuu,p:n.g6T,R:n.ZGq,S:n.JkR},stream_type:i.DX,screen:i.rV,camera:i.rV,custom:i.rV,preview_conf:i.rV,media_stream_id:i.DX}},4747:function(t,e,r){"use strict";r.d(e,{DX:function(){return i},Fs:function(){return o},V2:function(){return u},g1:function(){return s},rV:function(){return n}});var n=function(t){return t},i=function(t){return t},o=function(t){return t},s=function(t){return t},u=function(t){return t}},5341:function(t,e,r){"use strict";r.d(e,{CB:function(){return o},SE:function(){return s},eb:function(){return u},qI:function(){return i}});r(3873),r(5245);var n=r(9399);r(1945);function i(t){return/^([0-9a-zA-Z#!$%&()`'+-;<=.>@^_~,\\*])+$/.test(t)&&/^[^:/]*$/g.test(t)}function o(t){return!!(t.startsWith("rtmp://")||t.startsWith("avertp://")||t.startsWith("https://")&&t.endsWith(".flv")||t.startsWith("https://")&&t.endsWith(".m3u8"))}function s(t,e){return 0==e?(0,n.UH)(t)&&t%1==0&&t>=0:(0,n.UH)(t)&&t%1==0&&t>0}function u(t){for(var e in t)(0,n.OS)(t[e])?u(t[e]):t.hasOwnProperty(e)||((0,n.UH)(t[e])&&(t[e]=0),(0,n.Rk)(t[e])&&(t[e]=""))}},6306:function(t,e,r){"use strict";r.d(e,{$E:function(){return c},E3:function(){return i},Fq:function(){return h},GJ:function(){return n},Qx:function(){return a},b0:function(){return s},eW:function(){return f},v4:function(){return u},wM:function(){return o}});r(3720),r(1945);var n=Promise;document;var i="room not exist",o="device is not found",s="stream is not from zego",u="input param error",a="local stream wrong",c="no preview",f="publish stream no found",h="network is broken"},9399:function(t,e,r){"use strict";function n(t){return"number"==typeof t}function i(t){return"string"==typeof t}function o(t){return"boolean"==typeof t}function s(t){return void 0===t}function u(t){return null!==t&&t instanceof Object}function a(t){return"function"==typeof t}function c(t){return t instanceof Uint8Array}function f(t){return(t.startsWith("preset-id://")||t.startsWith("http")||t.startsWith("https"))&&(t.endsWith(".jpg")||t.endsWith(".jpeg")||t.endsWith(".png"))}r.d(e,{I_:function(){return c},OS:function(){return u},Qo:function(){return s},Rk:function(){return i},UH:function(){return n},ZV:function(){return o},Zv:function(){return f},ae:function(){return a}})},8413:function(t,e,r){"use strict";var n=r(2100);const i=r(3720);n.util.Long=i,n.util.Long.fromBits=n.util.Long?n.util.Long.fromBits:function(){return 0};for(var o=n.roots,s=n.types?n.types.basic:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0,string:2,bytes:2},u=n.types?n.types.packed:{double:1,float:5,int32:0,uint32:0,sint32:0,fixed32:5,sfixed32:5,int64:0,uint64:0,sint64:0,fixed64:1,sfixed64:1,bool:0},a=Object.keys(s),c={$:function(t){return c[t]?c[t].call(this):o[t].decode?o[t].decode(this,this.uint32()):c.$.call(this,"int32")}},f={$:function(t,e,r){var n=s[t];return void 0===n?o[t].encode?(this.uint32((r<<3|2)>>0).fork(),o[t].encode(e,this).ldelim()):f.$.call(this,"int32",e,r):f[t].call(this.uint32(r<<3|n),e)}},h=0;h<a.length;h++)c[a[h]]=n.Reader.prototype[a[h]],f[a[h]]=n.Writer.prototype[a[h]];!function t(e,r,i,a){for(var h=0,d=Object.keys(e);h<d.length;h++){var _=d[h];if(e[_].$m&&Object.keys(e[_].$m).every((function(t){return Number(t)}))){if(i[_])throw Error(`nested type ${i}.${_} has already exist`);i[_]=function(e,i){function a(t){for(var r in e){var n=e[r];"{"===n[1].charAt(0)?this[n[0]]={}:"["!==n[1].charAt(0)&&"<"!==n[1].charAt(0)||(this[n[0]]=[])}if(t)for(var i=Object.keys(t),o=0;o<i.length;++o)null!=t[i[o]]&&(this[i[o]]=t[i[o]])}var h={};for(var d in e){var _=e[d],l=_[1];"{"===l.charAt(0)?(a.prototype[_[0]]=n.util.emptyObject,h[l]={$m:l.substring(1).split(",").map((function(t,e){return[`$${e+1}`,t,null]})).reduce((function(t,e,r){return t[r+1]=e,t}),{})}):a.prototype[_[0]]="["===l.charAt(0)||"<"===l.charAt(0)?n.util.emptyArray:"bytes"===l?n.util.newBuffer([]):_[2]&&_[2].hasOwnProperty("low")&&_[2].hasOwnProperty("high")?n.util.Long.fromBits(_[2].low,_[2].high,_[2].unsigned):_[2]}return a.create=function(t){return new a(t)},a.decode=function(t,r){t instanceof n.Reader||(t=n.Reader.create(t));for(var i=void 0===r?t.len:t.pos+r,s=new a;t.pos<i;){var f=t.uint32(),h=f>>>3;if(h>0&&e[h]){var d=e[h][0],_=e[h][1];if("{"===_.charAt(0)){s[d]===n.util.emptyObject&&(s[d]={});var l=a.$namespace[_].decode(t,t.uint32());s[d][l.$1]=l.$2}else if("["===_.charAt(0)||"<"===_.charAt(0)){_=_.substring(1),s[d]&&s[d].length||(s[d]=[]);if(void 0!==u[_=!c[_]&&!o[_].decode?"int32":_]&&2==(7&f))for(var m=t.uint32()+t.pos;t.pos<m;)s[d].push(c.$.call(t,_));else s[d].push(c.$.call(t,_))}else s[d]=c.$.call(t,_)}else t.skipType(7&f)}return s},a.encode=function(t,r){for(var i in r||(r=n.Writer.create()),e){var c=e[i][0],h=e[i][1];if("{"===h.charAt(0)){if(null!=t[c]&&t.hasOwnProperty(c))for(var d=0,_=Object.keys(t[c]);d<_.length;++d)r.uint32((i<<3|2)>>0).fork(),a.$namespace[h].encode({$1:_[d],$2:t[c][_[d]]},r).ldelim()}else if("["===h.charAt(0)||"<"===h.charAt(0)){var l="<"===h.charAt(0);h=h.substring(1);var m=t[c];if(null!=m&&m.length){if(h=void 0===s[h]&&!o[h].encode?"int32":h,l&&void 0!==u[h]){r.uint32((i<<3|2)>>0).fork();for(d=0;d<m.length;d++)f[h].call(r,m[d]);r.ldelim()}else for(d=0;d<m.length;d++)f.$.call(r,h,m[d],i)}}else null!=t[c]&&t.hasOwnProperty(c)&&f.$.call(r,h,t[c],i)}return r},Object.keys(h).length&&(a.$namespace=t(h,r+"."+i,a.$namespace||{},!0)),a}(e[_].$m,_)}else e[_].$s?i[_]=function(t,e){function i(t,e,r){n.rpc.Service.call(this,t,e,r)}return(i.prototype=Object.create(n.rpc.Service.prototype)).constructor=i,i.create=function(t,e,r){return new i(t,e,r)},Object.keys(t).forEach((function(n){var s=t[n];function u(t,e){return this.rpcCall(u,o[s[0]],o[s[1]],t,e)}Object.defineProperty(u,"name",{value:n}),Object.defineProperty(u,"path",{value:`${r}.${e}`}),i.prototype[n]=u})),i}(e[_].$s,_):e[_].$e&&Object.values(e[_].$e).every((function(t){return Number(t)===t}))&&(i[_]=function(t,e){for(var r=Object.keys(t),n={},i=0;i<r.length;i++)n[n[r[i]]=t[r[i]]]=r[i];return n}(e[_].$e));i[_]&&!a&&(o[`${r}.${_}`]=i[_]),delete e[_].$m,delete e[_].$s,delete e[_].$e,i[_]=t(e[_],r?`${r}.${_}`:_,i[_]||{})}return i}({mixstream:{proto_mixstream:{MixAdvanceConfig:{$m:{1:["key","string",""],2:["value","string",""]}},MixImage:{$m:{1:["url","string",""],2:["display_mode","int32",0]}},MixInputStream:{$m:{1:["stream_input_common","mixstream.proto_mixstream.MixInputStreamCommon",null],2:["volume","int32",0],3:["audio_focus","int32",0],4:["audio_h_angle","int32",0],5:["render_mode","int32",0],6:["corner_radius","uint32",0],7:["label","mixstream.proto_mixstream.MixLabel",null],8:["image","mixstream.proto_mixstream.MixImage",null]}},MixInputStreamCommon:{$m:{1:["stream_id","string",""],2:["sound_level_id","uint32",0],3:["content_control","int32",0],4:["layer_rect","mixstream.proto_mixstream.MixRect",null],5:["stream_url","string",""]}},MixLabel:{$m:{1:["text","string",""],2:["text_left","int32",0],3:["text_top","int32",0],4:["font","mixstream.proto_mixstream.MixLableFont",null]}},MixLableFont:{$m:{1:["font_type","int32",0],2:["font_size","int32",0],3:["font_color","int32",0],4:["font_transparency","int32",0],5:["font_border_color","sint32",0]}},MixOutputStream:{$m:{1:["output_stream_common","mixstream.proto_mixstream.MixOutputStreamCommon",null],2:["video_enc_id","int32",0],3:["video_encode_latency","int32",0],4:["video_encode_profile","int32",0],5:["low_bitrate_hd","int32",0]}},MixOutputStreamCommon:{$m:{1:["is_url","int32",0],2:["target","string",""],3:["video_fps","int32",0],4:["rate_control_mode","int32",0],5:["video_bitrate","int32",0],6:["video_width","int32",0],7:["video_height","int32",0],8:["output_quality","int32",0],9:["audio_bitrate","int32",0],10:["audio_enc_id","int32",0]}},MixRect:{$m:{1:["top","int32",0],2:["left","int32",0],3:["bottom","int32",0],4:["right","int32",0],5:["layer","int32",0]}},MixStartReplyData:{$m:{1:["request_id","string",""],2:["play_infos","<mixstream.proto_mixstream.PlayInfo",null]}},MixStreamCommon:{$m:{1:["user_data","string",""],2:["output_bg_color","int32",0],3:["output_bg_image","string",""],4:["with_sound_level","int32",0],5:["single_stream_pass_through","int32",0],6:["alignment_type","int32",0]}},MixstreamServerCommonResponse:{$m:{1:["code","uint32",0],2:["message","string",""]}},MixStreamStartRequest:{$m:{1:["request_seq","uint32",0],2:["mix_protocol_version","int32",0],3:["task_id","string",""],4:["room_id","string",""],5:["mix_stream_common","mixstream.proto_mixstream.MixStreamCommon",null],6:["audio_channel_cnt","int32",0],7:["audio_mix_mode","int32",0],8:["recv_buffer_level","sint32",0],9:["input_stream","<mixstream.proto_mixstream.MixInputStream",null],10:["water_mark","mixstream.proto_mixstream.MixWaterMark",null],11:["advance_config","<mixstream.proto_mixstream.MixAdvanceConfig",null],12:["output_stream","<mixstream.proto_mixstream.MixOutputStream",null],13:["white_board","mixstream.proto_mixstream.MixWhiteBoard",null],14:["timestamp","int64",{low:0,high:0,unsigned:!1}]}},MixStreamStartResponse:{$m:{1:["request_seq","uint32",0],2:["common_response","mixstream.proto_mixstream.MixstreamServerCommonResponse",null],3:["data","mixstream.proto_mixstream.MixStartReplyData",null],4:["error_streamid_list","<string",null]}},MixStreamStopRequest:{$m:{1:["request_seq","uint32",0],2:["task_id","string",""],3:["room_id","string",""],4:["is_url","int32",0],5:["target","string",""],6:["timestamp","int64",{low:0,high:0,unsigned:!1}]}},MixStreamStopResponse:{$m:{1:["request_seq","uint32",0],2:["common_response","mixstream.proto_mixstream.MixstreamServerCommonResponse",null]}},MixWaterMark:{$m:{1:["image","string",""],2:["layout_rect","mixstream.proto_mixstream.MixRect",null]}},MixWhiteBoard:{$m:{1:["whiteboard_id","uint64",{low:0,high:0,unsigned:!0}],2:["horizontal_ratio","int32",0],3:["vertical_ratio","int32",0],4:["is_ppt_animation","int32",0],5:["layout_rect","mixstream.proto_mixstream.MixRect",null],6:["background_color","int32",0]}},PlayInfo:{$m:{1:["stream_alias","string",""],2:["rtmp_url","string",""],3:["hls_url","string",""],4:["hdl_url","string",""]}}}}},"",o,!1),e.Z=o.mixstream},4119:function(t){"use strict";t.exports=__WEBPACK_EXTERNAL_MODULE__4119__}},__webpack_module_cache__={};function __webpack_require__(t){var e=__webpack_module_cache__[t];if(void 0!==e)return e.exports;var r=__webpack_module_cache__[t]={exports:{}};return __webpack_modules__[t].call(r.exports,r,r.exports,__webpack_require__),r.exports}__webpack_require__.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=function(t,e){for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},__webpack_require__.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var __webpack_exports__={};return function(){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{MixStream:function(){return R}});var t,e,r,n=__webpack_require__(1945),i={NOT_LOGIN:n.Tmx,INPUT_PARAM:n.QtR,TIMEOUT:n.LXI,MIXER_NO_SERVICES:{code:1005e3,message:"no mix stream service"},MIXER_TASK_ID_NULL:{code:1005001,message:"mixer task is null"},MIXER_TASK_ID_TOO_LONG:{code:1005002,message:"task ID is too long"},MIXER_TASK_ID_INVALID_CHARACTER:{code:1005003,message:"task ID contains illegal characters"},MIXER_NO_OUTPUT_TARGET:{code:1005005,message:"task configuration does not specify output"},MIXER_OUTPUT_TARGET_INVALID:{code:1005006,message:"stream output target is incorrect"},MIXER_START_REQUEST_ERROR:{code:1005010,message:"start mixer task fail, possibly due to network reasons"},MIXER_STOP_REQUEST_ERROR:{code:1005011,message:"stop mixer task fail, possibly due to network reasons"},MIXER_NOT_OWNER_STOP_MIXER:{code:1005012,message:" maxed task must be stopped by the start user of the task"},MIXER_INPUTLIST_NULL:{code:1005020,message:"Mixed stream task input list is null"},MIXER_OUTPUTLIST_NULL:{code:1005021,message:"Mixed stream task output list is null"},MIXER_VIDEO_CONFIG_INVALID:{code:1005023,message:"invalid mixed stream task video configuration"},MIXER_EXCEED_MAX_INPUT_COUNT:{code:1005025,message:"more than the maximum number of input streams"},MIXER_INPUT_STREAM_NOT_EXISTS:{code:1005026,message:"Input stream does not exist"},MIXER_INPUT_PARAMETERS_ERROR:{code:1005027,message:"mix stream input parameters are wrong"},MIXER_INPUT_LABEL_TOO_LONG:{code:1005028,message:"Input stream label text is too long"},MIXER_EXCEED_MAX_OUTPUT_COUNT:{code:1005030,message:"more than the maximum number of output streams"},MIXER_INPUT_IMAGE_URL_TOO_LONG:{code:1005034,message:"Input stream image url too long"},MIXER_INPUT_IMAGE_FORMAT_WRONG:{code:1005035,message:"Input stream image format wrong"},MIXER_INPUT_IMAGE_GET_FAIL:{code:1005036,message:"Input stream image get fail"},MIXER_AUTHENTICATION_FAILED:{code:1005050,message:"mixed stream authentication failed"},MIXER_WATERMARK_NULL:{code:1005061,mag:"input watermark is null"},MIXER_WATERMARK_PARAMETERS_ERROR:{code:1005062,message:"input watermark parameter is wrong"},MIXER_WATERMARK_URL_INVALID:{code:1005063,message:"illegal input watermark URL"},MIXER_BACKGROUND_IMAGE_URL_INVALID:{code:1005067,message:"illegal input background image URL"},MIXER_REPEAT_INPUT:{code:1005099,message:"mix stream input repeat"},MIXER_INNER_ERROR:{code:1005099,message:"mixer internal error"}};t=__webpack_require__(8413).Z.proto_mixstream,e=__webpack_require__(2100),r=__webpack_require__(3720),e.util.Long=r,e.configure();var o,s,u=function(){function e(){}return e.prototype.encodeMixStreamStartReq=function(e){var r=t.MixStreamStartRequest.create(e);return t.MixStreamStartRequest.encode(r).finish()},e.prototype.decodeMixStreamStartRsp=function(e){return t.MixStreamStartResponse.decode(e)},e.prototype.encodeMixStreamStopReq=function(e){var r=t.MixStreamStopRequest.create(e);return t.MixStreamStopRequest.encode(r).finish()},e.prototype.decodeMixStreamStopRsp=function(e){return t.MixStreamStopResponse.decode(e)},e}(),a=__webpack_require__(4747),c={event:"/mix/start_mix",error:{i:i.INPUT_PARAM,T:i.MIXER_TASK_ID_NULL,O:i.MIXER_TASK_ID_TOO_LONG,C:i.MIXER_TASK_ID_INVALID_CHARACTER,k:i.MIXER_INPUTLIST_NULL,D:i.MIXER_OUTPUTLIST_NULL,N:i.MIXER_OUTPUT_TARGET_INVALID,A:i.MIXER_NO_OUTPUT_TARGET,U:i.MIXER_START_REQUEST_ERROR,q:i.MIXER_INNER_ERROR,P:i.MIXER_INPUT_LABEL_TOO_LONG,V:i.MIXER_INPUT_IMAGE_URL_TOO_LONG,X:i.MIXER_INPUT_IMAGE_FORMAT_WRONG,j:i.MIXER_WATERMARK_URL_INVALID,B:i.NOT_LOGIN},mix_stream_conf:a.rV,stop_reason:a.DX},f={event:"/mix/stop_mix",error:{i:i.INPUT_PARAM,T:i.MIXER_TASK_ID_NULL,U:i.MIXER_STOP_REQUEST_ERROR,q:i.MIXER_INNER_ERROR,B:i.NOT_LOGIN}},h={event:"/mix/config_mix",error:{i:i.INPUT_PARAM,G:i.MIXER_VIDEO_CONFIG_INVALID,F:i.MIXER_BACKGROUND_IMAGE_URL_INVALID,B:i.NOT_LOGIN},mix_params:a.rV},d=__webpack_require__(9399),_=__webpack_require__(5341),l=__webpack_require__(6306),m=__webpack_require__(5245),v=function(){return v=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},v.apply(this,arguments)};function g(t,e){var r,n,o,s,u="",a=i;return e.errorCode<2e9&&e.errorCode>1e9?(o={1:"MIXER_START_REQUEST_ERROR",2:"MIXER_START_REQUEST_ERROR",3:"MIXER_AUTHENTICATION_FAILED",141:"MIXER_INPUT_IMAGE_FORMAT_WRONG",142:"MIXER_INPUT_IMAGE_GET_FAIL",150:"MIXER_INPUT_STREAM_NOT_EXISTS",151:"MIXER_START_REQUEST_ERROR",152:"MIXER_STOP_REQUEST_ERROR",153:"MIXER_INPUT_PARAMETERS_ERROR",154:"MIXER_EXCEED_MAX_OUTPUT_COUNT",155:"MIXER_INPUT_PARAMETERS_ERROR",156:"MIXER_VIDEO_CONFIG_INVALID",157:"MIXER_NO_SERVICES",158:"MIXER_EXCEED_MAX_INPUT_COUNT",159:"MIXER_START_REQUEST_ERROR",160:"MIXER_NOT_OWNER_STOPMIXER",170:"MIXER_WATERMARK_PARAMETERS_ERROR",171:"MIXER_WATERMARK_NULL",175:"MIXER_REPEAT_INPUT",179:"MIXER_INPUT_LABEL_TOO_LONG",190:"MIXER_START_REQUEST_ERROR"},s="MIXER_INNER_ERROR",(n=e.errorCode-1e4)>1e9&&o[n-1e9]&&(s=o[n-1e9]),r=a[u=s]):e.errorCode<1e6&&(r=t.decodeServerError(e.errorCode,e.extendedData),u=t.getLiveRoomError(e.errorCode,t.useNetAgent)),{reportErr:r,actualError:a[u]}}o=__webpack_require__(3720),function(t){t[t.I=0]="I",t[t.H=10]="H",t[t.M=100]="M",t[t.L=1e3]="L"}(s||(s={}));var p={},b={startMixerTask:function(t){var e=this;return new l.GJ((function(r,n){var o,u,a,f,h,l,b,E,R,I,x,w=e.reporter.createSpan(s.H,{key:m.MK.event},{key:c.event,par:t.taskID},c.event,!0),M={errorCode:i.MIXER_INPUT_PARAMETERS_ERROR.code,extendedData:i.MIXER_INPUT_PARAMETERS_ERROR.message};if(!!(null==t?void 0:t.inputList.find((function(t){return null==t.streamID&&(M.extendedData=M.extendedData+". streamID should be of string type",!0)}))))return e.reporter.setError(w,i.MIXER_INPUT_PARAMETERS_ERROR),void n(M);var S=t.outputConfig;S&&S.outputFps&&(S.outputFPS=S.outputFps);var T=function(r){var i=g(e.stateCenter,r),o=i.reportErr,s=i.actualError;1000010150===r.errorCode&&w.setAttributes({stop_reason:"UnmatchStreamId"}),e.reporter.setError(w,o||r),e.reporter.spanEnd({key:c.event,par:t.taskID}),s&&(r.errorCode=null==s?void 0:s.code,r.extendedData=(null==s?void 0:s.message)||""),n(r)},y=e.stateCenter.roomList[0];if(y){var O,C=[];if(!t.noTaskID&&!t.taskID)return e.logger.error("zb.sh.ums no taskId found"),void T({errorCode:c.error.T.code,extendedData:c.error.T.message});if(!t.noTaskID&&!(0,d.Rk)(t.taskID))return e.logger.error("zb.rh.lg taskId must be string"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!t.noTaskID&&t.taskID.length>256)return e.logger.error("zb.sh.ums taskId is too long"),void T({errorCode:c.error.O.code,extendedData:c.error.O.message});if(!t.noTaskID&&!(0,_.qI)(t.taskID))return e.logger.error("zb.sh.ums task ID contains illegal characters"),void T({errorCode:c.error.C.code,extendedData:c.error.C.message});if(!t.inputList||0==t.inputList.length)return e.logger.error("zb.sh.ums input list wrong"),void T({errorCode:c.error.k.code,extendedData:c.error.k.message});t.inputList.forEach((function(t){"AUDIO"===t.contentType&&(!t.layout&&(t.layout={top:0,left:0,bottom:0,right:0}),t.layout.top=0,t.layout.left=0,t.layout.bottom=1,t.layout.right=1)}));for(var k=0;k<t.inputList.length;k++){var D=t.inputList[k],N={errorCode:c.error.i.code,extendedData:c.error.i.message};if(!(0,d.OS)(D.layout))return e.logger.error("zb.sh.ums input layout must be object"),void T(N);var A=D.layout,z=A.bottom,U=A.left,L=A.right;if(!((0,_.SE)(A.top,!1)&&(0,_.SE)(z,!1)&&(0,_.SE)(U,!1)&&(0,_.SE)(L,!1)))return e.logger.error("zb.sh.ums topleftbottomright must be integer number"),void T(N);if(void 0!==D.renderMode&&![0,1].includes(D.renderMode))return e.logger.error("zb.sh.ums render_mode is wrong"),void T(N);if(void 0!==D.imageInfo){if(!(0,d.Rk)(D.imageInfo.url))return e.logger.error("zb.sh.ums image url is require string"),void T(N);if(D.imageInfo.url.length>1024)return e.logger.error("zb.sh.ums input image url length too long"),void T({errorCode:c.error.V.code,extendedData:c.error.V.message})}if(!(0,d.Qo)(D.label)){if(!(0,d.Rk)(null===(o=D.label)||void 0===o?void 0:o.text)||(null===(u=D.label)||void 0===u?void 0:u.text.length)>=300)return e.logger.error("zb.sh.ums input label text is not string or too long"),void T({errorCode:c.error.P.code,extendedData:c.error.P.message});var q=D.label,P=q.left,V=q.top;if(void 0!==P&&!(0,_.SE)(P,!1)||void 0!==V&&!(0,_.SE)(V,!1))return e.logger.error("zb.sh.ums input label left and top should be integer"),void T(N)}if(void 0!==D.cornerRadius&&!(0,_.SE)(D.cornerRadius,!1))return e.logger.error("zb.sh.ums cornerRadius is wrong"),void T(N);if(void 0!==D.soundLevelID&&!(0,_.SE)(D.soundLevelID,!1))return e.logger.error("zb.sh.ums soundLevelID is wrong"),void T(N)}if(!t.outputList||0==t.outputList.length)return e.logger.error("zb.sh.ums no output list found"),void T({errorCode:c.error.D.code,extendedData:c.error.D.message});if(t.outputList.some((function(t){return(0,d.Rk)(t)&&!(0,_.CB)(t)&&!(0,_.qI)(t)||(0,d.OS)(t)&&t.target&&!(0,_.CB)(t.target)&&!(0,_.qI)(t.target)})))return e.logger.error("zb.sh.ums stream output target is incorrect"),void T({errorCode:c.error.N.code,extendedData:c.error.N.message});if(!((O=t.inputList.every((function(t){return"AUDIO"===t.contentType})))||S&&(0,d.OS)(S)))return e.logger.error("zb.sh.ums no output config found"),void T({errorCode:c.error.A.code,extendedData:c.error.A.message});if(O&&(t.outputConfig=S=v(v({},S||{}),{outputBitrate:.001,outputFPS:1,outputWidth:1,outputHeight:1})),!(O||S.outputBitrate&&(0,_.SE)(S.outputBitrate)))return e.logger.error("zb.sh.ums bitrate param is required and must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!S.outputFPS||!(0,_.SE)(S.outputFPS))return e.logger.error("zb.sh.ums fps param is required and must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!S.outputWidth||!(0,_.SE)(S.outputWidth))return e.logger.error("zb.sh.ums width param is required and must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!S.outputHeight||!(0,_.SE)(S.outputHeight))return e.logger.error("zb.sh.ums height param is required and must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(void 0!==S.outputAudioCodecID&&!(0,_.SE)(S.outputAudioCodecID,!1))return e.logger.error("zb.sh.ums AudioCodecID param must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(void 0!==S.outputAudioBitrate&&!(0,_.SE)(S.outputAudioBitrate))return e.logger.error("zb.sh.ums AudioBitrate param must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(void 0!==S.outputAudioChannels&&!(0,_.SE)(S.outputAudioChannels,!1))return e.logger.error("zb.sh.ums AudioChannels param must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!(0,d.Qo)(t.watermark)){if(!(0,d.Rk)(null===(a=t.watermark)||void 0===a?void 0:a.imageURL))return e.logger.error("zb.sh.ums watermark image type error"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!(0,d.Zv)(null===(f=t.watermark)||void 0===f?void 0:f.imageURL))return e.logger.error("zb.sh.ums watermark image url invalid"),void T({errorCode:c.error.j.code,extendedData:c.error.j.message})}if(!(0,d.Qo)(t.whiteboard)){if(!(0,d.Rk)(null===(h=t.whiteboard)||void 0===h?void 0:h.whiteboardID))return e.logger.error("zb.sh.ums whiteboard is required and must be string"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!(0,d.OS)(null===(l=t.whiteboard)||void 0===l?void 0:l.layout))return e.logger.error("zb.sh.ums whiteboard layout must be object"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});var X=null===(b=t.whiteboard)||void 0===b?void 0:b.layout;z=X.bottom,U=X.left,L=X.right;if(!((0,_.SE)(X.top,!1)&&(0,_.SE)(z,!1)&&(0,_.SE)(U,!1)&&(0,_.SE)(L,!1)))return e.logger.error("zb.sh.ums whiteboard topleftbottomright must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});var j=t.whiteboard,$=j.horizontalRatio,H=j.verticalRatio,B=j.isPPTAnimation,G=j.zOrder,F=j.backgroundColor;if(!(0,d.Qo)($)&&!(0,_.SE)($))return e.logger.error("zb.sh.ums horizontalRatio must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!(0,d.Qo)(H)&&!(0,_.SE)(H))return e.logger.error("zb.sh.ums verticalRatio must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!(0,d.Qo)(B)&&!(0,d.ZV)(B))return e.logger.error("zb.sh.ums isPPTAnimation must be boolean"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!(0,d.Qo)(G)&&!(0,_.SE)(G,!1))return e.logger.error("zb.sh.ums zOrder must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});if(!(0,d.Qo)(F)&&!(0,_.SE)(F,!1))return e.logger.error("zb.sh.ums backgroundColor must be integer number"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message})}if(!(0,d.Qo)(t.enableSoundLevel)&&!(0,d.ZV)(t.enableSoundLevel))return e.logger.error("zb.sh.ums enableSoundLevel is not bool"),void T({errorCode:c.error.i.code,extendedData:c.error.i.message});for(k=0;k<t.inputList.length;k++){var W=t.inputList[k],Q=W.streamID;e.stateCenter.testEnvironment&&(Q="zegotest-"+e.stateCenter.appid+"-"+W.streamID),C.push({stream_id:Q,content_control:"AUDIO"===W.contentType?1:0,top:null===(E=W.layout)||void 0===E?void 0:E.top,left:null===(R=W.layout)||void 0===R?void 0:R.left,bottom:null===(I=W.layout)||void 0===I?void 0:I.bottom,right:null===(x=W.layout)||void 0===x?void 0:x.right,render_mode:W.renderMode,image:W.imageInfo,label:W.label})}var K=[];t.outputList.forEach((function(t){var e="";(0,d.Rk)(t)?e=t:(0,d.OS)(t)&&t.target&&(e=t.target);var r=0;(e.startsWith("rtmp://")||e.startsWith("https://")&&e.endsWith(".flv")||e.startsWith("https://")&&e.endsWith(".m3u8"))&&(r=1),K.push({target:e,is_url:r?"true":"false"})}));e.reporter.spanSetAttributes({key:c.event,par:t.taskID},{mix_stream_conf:c.mix_stream_conf({fps:S.outputFPS,bitrate:S.outputBitrate,w:S.outputWidth,h:S.outputHeight,stream_cnt:C.length,mix_task_id:t.taskID,input_stream_list:C,output_target_list:K})}),y.streamHandler.updateMixStream(t,p,(function(n){e.reporter.spanEnd({key:c.event,par:t.taskID}),r(n)}),T)}else T({errorCode:c.error.B.code,extendedData:c.error.B.message})}))},setMixerTaskConfig:function(t){var e=this;return new l.GJ((function(r,n){var i,o=e.reporter.createSpan(s.H,{key:m.MK.event},{key:""},h.event),u={},a=function(t){e.reporter.setError(o,t),n(t)};if(t&&t.videoCodec){var c=t.videoCodec.toLowerCase();if(-1==["vp8","h264"].indexOf(c))return e.logger.error("zb.sh.ums param videoCode error"),a({errorCode:h.error.G.code,extendedData:h.error.G.message}),!1;u.videoCodec=c}if(t.backgroundColor){if(!(0,_.SE)(t.backgroundColor))return e.logger.error("zb.sh.ums param backgroundColor must be integer number"),a({errorCode:h.error.i.code,extendedData:h.error.i.message}),!1;u.backgroundColor=t.backgroundColor}var f=t.backgroundImage;if(f){if(!(0,d.Rk)(f))return e.logger.error("zb.sh.ums param outputBgImage error"),a({errorCode:h.error.i.code,extendedData:h.error.i.message}),!1;if(!f.startsWith("preset-id://")||!f.endsWith(".jpg")&&!f.endsWith(".png"))return e.logger.error("zb.sh.ums illegal input background image URL"),a({errorCode:h.error.F.code,extendedData:h.error.F.message}),!1;u.backgroundImage=f}var l=t&&t.userData;if(l){if(!(0,d.I_)(l))return e.logger.error("zb.sh.ums param userData required Uint8Array"),a({errorCode:h.error.i.code,extendedData:h.error.i.message}),!1;if(l.byteLength>1e3)return e.logger.error("zb.sh.ums param userData should shorter than 1000"),a({errorCode:h.error.i.code,extendedData:h.error.i.message}),!1;u.userData=l}t.extraParams&&(u.extraParams||(u.extraParams=[]),(i=u.extraParams).push.apply(i,t.extraParams)),p=u,o.setAttributes({mix_params:h.mix_params(t)}),e.stateCenter.roomList[0]?(o.end(),r({errorCode:0,extendedData:""})):a({errorCode:h.error.B.code,extendedData:h.error.B.message})}))},stopMixerTask:function(t){var e=this;return new l.GJ((function(r,n){var i=e.reporter.createSpan(s.H,{key:m.MK.event},{key:""},f.event);if(!t||!(0,d.Rk)(t)||t.length>256||!(0,_.qI)(t))return e.logger.error("zb.rh.lg taskID must be string less 256"),e.reporter.setError(i,f.error.i," param taskID error"),void n({errorCode:f.error.i.code,extendedData:f.error.i.message+" param taskID error"});i.setAttributes({mix_task_id:t});var o=function(t){var r=g(e.stateCenter,t),o=r.actualError;e.reporter.setError(i,r.reportErr||t),o&&(t.errorCode=null==o?void 0:o.code,t.extendedData=(null==o?void 0:o.message)||""),n(t)},u=e.stateCenter.roomList[0];u?u.streamHandler.stopMixStream(t,(function(t){i.end(),r(t)}),o):o({errorCode:f.error.B.code,extendedData:f.error.B.message})}))}},E={_sendMixStopReqByAccessHub:function(t,e,r){var n=this;this.mixStreamProtoBuf||(this.mixStreamProtoBuf=new u),t.timestamp=o.fromInt(Math.ceil((new Date).getTime()/1e3)),this.logger.info("zb.sh.smseba.1 req "+JSON.stringify(t));var s=this.mixStreamProtoBuf.encodeMixStreamStopReq(t),a=function(e,r){try{var i=n.mixStreamProtoBuf.decodeMixStreamStopRsp(e);(0,_.eb)(i),n.logger.info("zb.sh.smseba.1 rsp "+JSON.stringify(t));var o=(null==i?void 0:i.common_response)||{};return{code:o.code,msg:o.message}}catch(t){return{code:-1}}};this.sendMixRequest({interfaceID:16},s,(function(t,n){var i=a(t),o=i.code,s=i.msg;0!=o&&null!=o||!(0,d.ae)(e)?r&&r({errorCode:o,extendedData:s||""}):e({errorCode:o,extendedData:s})}),(function(t,e,o){var s="";if(o)return o==i.TIMEOUT&&(o=c.error.U),o.code&&20010===o.code&&(o=JSON.parse(JSON.stringify(i.MIXER_NO_SERVICES))),void(r&&r(o,s));o=c.error.q;var u="";if((0,d.Rk)(e))u=e;else{var f=a(e);u=f.code+" "+f.msg}n.logger.error("zb.sh.pt "+(s="request media server fail, error: "+t+" "+u)),r&&r(o,s)}))},stopMixStream:function(t,e,r,n,i){this.logger.info("zb.sh.sms call");var o=this.getStopMixStreamParams(t,n,i);this.stateCenter.useNetAgent&&this._sendMixStopReqByAccessHub(o.mixStopReq,e,r)},_sendMixStartReqByAccessHub:function(t,e,r,n){var s=this;this.mixStreamProtoBuf||(this.mixStreamProtoBuf=new u),t.timestamp=o.fromInt(Math.ceil((new Date).getTime()/1e3)),this.logger.info("zb.sh.smseba.0 req "+JSON.stringify(t));var a=this.mixStreamProtoBuf.encodeMixStreamStartReq(t),f=function(t,e){try{var r=s.mixStreamProtoBuf.decodeMixStreamStartRsp(t);(0,_.eb)(r),s.logger.info("zb.sh.smseba.0 rsp "+JSON.stringify(r));var n=r.common_response;return{code:n.code,msg:n.message,data:r.data,errStreamList:r.error_streamid_list}}catch(t){return{code:-1}}};this.sendMixRequest({interfaceID:15},a,(function(t,i){var o=f(t),u=o.code,a=o.errStreamList;if(void 0===u||0==u){var c=o.data.play_infos.map((function(t){var r={rtmpURL:"",hlsURL:"",flvURL:""},n=t.stream_alias||"";return s.stateCenter.testEnvironment&&n&&n.startsWith(e)&&(n=n.slice(e.length)),r.streamID=n,t.rtmp_url&&t.rtmp_url.length>0&&(r.rtmpURL=t.rtmp_url),t.hls_url&&t.hls_url.length>0&&(r.hlsURL=t.hls_url),t.hdl_url&&t.hdl_url.length>0&&(r.flvURL=t.hdl_url),r}));if(r)r({errorCode:0,extendedData:JSON.stringify({mixerOutputList:c})})}else{var h="",d=u+1e9;if(1000000150==d&&a){var _=a.map((function(t){return s.stateCenter.testEnvironment&&t.startsWith(e)?t.slice(e.length):t}))||[];_.length>0&&(s.logger.debug("zb.sh.ums not exist streams: "+_),h=_.join(","))}n&&n({errorCode:s.stateCenter.getServerError(1e4+d,s.stateCenter.useNetAgent).code,extendedData:h})}}),(function(t,e,r){var o="";if(r)return r==i.TIMEOUT&&(r=c.error.U),r.code&&20010===r.code&&(r=JSON.parse(JSON.stringify(i.MIXER_NO_SERVICES))),void(n&&n(r,o));r=c.error.q;var u="";if((0,d.Rk)(e))u=e;else{var a=f(e);u=a.code+" "+a.msg}s.logger.error("zb.sh.pt "+(o="request media server fail, error: "+t+" "+u)),n&&n(r,o)}))},getStartMixStreamParams:function(t,e){var r,n,i=this,s={request_seq:this.stateCenter.getSeq(),mix_protocol_version:1,task_id:t.taskID,room_id:this.roomID,mix_stream_common:{},input_stream:[],advance_config:[],output_stream:[]},u=t.outputConfig||{};u.singleStreamPassThrough&&(0,d.ZV)(u.singleStreamPassThrough)&&(s.mix_stream_common.single_stream_pass_through=u.singleStreamPassThrough?1:0);var a=e;if(a&&(a.videoCodec&&(null===(r=s.advance_config)||void 0===r||r.push({key:"video_encode",value:a.videoCodec})),a.backgroundColor&&(s.mix_stream_common.output_bg_color=a.backgroundColor),a.backgroundImage&&(s.mix_stream_common.output_bg_image=a.backgroundImage),a.userData&&(s.mix_stream_common.user_data=this.stateCenter.uint8arrayToBase64(a.userData)),a.extraParams&&(null===(n=s.advance_config)||void 0===n||n.push.apply(n,a.extraParams))),void 0!==t.enableSoundLevel&&(s.mix_stream_common.with_sound_level=t.enableSoundLevel?1:0),t.inputList.forEach((function(t,e){var r,n,o,u,a,c,f,h,d,_,l,m,v,g,p,b,E,R,I,x,w,M=t.streamID;i.stateCenter.testEnvironment&&(M="zegotest-"+i.stateCenter.appid+"-"+t.streamID);var S={stream_input_common:{stream_id:M,content_control:"AUDIO"===t.contentType?1:0,layer_rect:{layer:null===(r=t.layout)||void 0===r?void 0:r.layer,top:null===(n=t.layout)||void 0===n?void 0:n.top,left:null===(o=t.layout)||void 0===o?void 0:o.left,bottom:null===(u=t.layout)||void 0===u?void 0:u.bottom,right:null===(a=t.layout)||void 0===a?void 0:a.right}},volume:100,audio_h_angle:-1,render_mode:t.renderMode,corner_radius:t.cornerRadius};if(null===(c=t.label)||void 0===c?void 0:c.text){var T={font_type:(null===(h=null===(f=t.label)||void 0===f?void 0:f.font)||void 0===h?void 0:h.type)||0,font_size:(null===(_=null===(d=t.label)||void 0===d?void 0:d.font)||void 0===_?void 0:_.size)||24,font_color:(null===(m=null===(l=t.label)||void 0===l?void 0:l.font)||void 0===m?void 0:m.color)||16777215,font_transparency:(null===(g=null===(v=t.label)||void 0===v?void 0:v.font)||void 0===g?void 0:g.transparency)||0};T.font_border_color=(null===(b=null===(p=t.label)||void 0===p?void 0:p.font)||void 0===b?void 0:b.border)?null===(R=null===(E=t.label)||void 0===E?void 0:E.font)||void 0===R?void 0:R.borderColor:-1;var y={text:null===(I=t.label)||void 0===I?void 0:I.text,text_left:(null===(x=t.label)||void 0===x?void 0:x.left)||0,text_top:(null===(w=t.label)||void 0===w?void 0:w.top)||0,font:T};S.label=y}t.imageInfo&&(S.image=t.imageInfo),t.soundLevelID&&(S.stream_input_common.sound_level_id=t.soundLevelID),s.input_stream.push(S)})),t.outputList.forEach((function(t){var e,r,n="";if((0,d.Rk)(t)?n=t:(0,d.OS)(t)&&t.target?n=t.target:i.logger.error("zb.sh.ums output target required"),(0,_.CB)(n))e=1,r=n;else{e=0,r=i.stateCenter.testEnvironment?"zegotest-"+i.stateCenter.appid+"-"+n:n}var o={is_url:e,target:r,video_bitrate:1e3*u.outputBitrate,video_fps:u.outputFPS,video_width:u.outputWidth,video_height:u.outputHeight,output_quality:23};u.outputAudioCodecID&&(o.audio_enc_id=u.outputAudioCodecID),"vp8"===a.videoCodec?o.audio_enc_id=3:"h264"===a.videoCodec&&(o.audio_enc_id=0),u.outputAudioBitrate&&(o.audio_bitrate=1e3*u.outputAudioBitrate),s.output_stream.push({output_stream_common:o})})),t.watermark&&(s.water_mark={image:t.watermark.imageURL,layout_rect:t.watermark.layout}),t.whiteboard){var c=t.whiteboard,f=c.horizontalRatio,h=c.verticalRatio,l=c.layout,m=c.zOrder,g=c.isPPTAnimation,p=c.backgroundColor;s.white_board={whiteboard_id:o.fromString(c.whiteboardID),horizontal_ratio:f||16,vertical_ratio:h||9,is_ppt_animation:!0===g?1:0,layout_rect:v(v({},l),{layer:m||0}),background_color:p||4059296768}}return isNaN(t.streamAlignmentMode)||(s.alignment_type=t.streamAlignmentMode),s.audio_channel_cnt=u.outputAudioChannels?u.outputAudioChannels:1,{mixStartReq:s}},updateMixStream:function(t,e,r,n){this.logger.info("zb.sh.ums call"),this.logger.info("zb.sh.ums send command");var i=this.getStartMixStreamParams(t,e).mixStartReq;return this.stateCenter.useNetAgent&&this._sendMixStartReqByAccessHub(i,"zegotest-"+this.stateCenter.appid+"-",r,n),!0},getStopMixStreamParams:function(t,e,r){var n={id_name:this.stateCenter.idName,live_channel:this.roomID,appid:this.stateCenter.appid,version:"3.4.0"},i={request_seq:this.stateCenter.getSeq(),room_id:this.roomID};if((0,d.Rk)(t)&&(n.task_id=t,i.task_id=t),null!=e){var o=void 0;n.stream_id=o=this.stateCenter.testEnvironment?"zegotest-"+this.stateCenter.appid+"-"+e:e,i.is_url=0,i.target=o}else null!=r&&(n.mixurl=r,i.is_url=1,i.target=r);return{req_body:n,mixStopReq:i}}},R={type:"MixStream",install:function(t,e){for(var r in b)Object.defineProperty(t.prototype,r,{value:b[r],writable:!1});for(var r in E)Object.defineProperty(e.prototype,r,{value:E[r],writable:!1})}}}(),__webpack_exports__}()}));